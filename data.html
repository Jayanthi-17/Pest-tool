<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Pest Diagnostic Tool</title>
</head>
<body>
    <div id="CalculatorContainer"></div>

    <script>
        // Pest data structure based on the Excel content
        const pestData = [
             {
                name: "Anthracnose",
                type: "Disease (Fungal)",
                plants: ["Beans", "Cucumbers", "Melons", "Peppers", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Dark spots or blotches", "Yellowing around spots", "Curling or distorted leaves", "Premature leaf drop", "Dark or sunken areas on stems", "Tips of branches may die back", "Dark or sunken spots or patches on fruit"],
                prevention: ["Avoid overhead watering", "Improve air circulation", "Rotate crops", "Plant resistant varieties"],
                control: ["Prune infected areas", "Apply copper or sulfur-based fungicides early", "Destroy fallen debris"],
                link: "https://www.almanac.com/pest/anthracnose"
            },
            {
                name: "Aphids",
                type: "Insect (Sap-sucking pest)",
                plants: ["Beets", "Beans", "Cucumbers", "Gladioli", "Impatiens", "Lettuce", "Melons", "Petunias", "Phloxes", "Pumpkins", "Rudbeckias", "Spinach", "Squashes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Flowers", "Buds"],
                symptoms: ["Curled or distorted leaves", "Sticky residue (honeydew) on leaves", "Yellow leaves", "Clusters of tiny insects", "Sticky residue on stems", "Stunted growth or weakened shoots", "Deformed petals", "Flowers may drop early", "Distorted buds", "Buds fail to open"],
                prevention: ["Monitor regularly", "Avoid over-fertilizing", "Encourage beneficial insects such as ladybugs or lacewings", "Remove weeds nearby"],
                control: ["Use a high pressure spray from the garden hose", "Follow up with two applications of insecticidal soap, one week apart"],
                link: "https://www.almanac.com/pest/aphids"
            },
            {
                name: "Armyworm",
                type: "Insect",
                plants: ["Beans", "Corn"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Chewed or ragged leaves", "Holes in leaves", "Missing leaves", "Weakening of shoots", "Chewed spots or holes in fruit"],
                prevention: ["Monitor regularly", "Remove weeds", "Avoid planting susceptible crops in infested areas"],
                control: ["Scout early and often", "Apply Bacillus thuringiensis (Bt) or spinosad", "Use neem oil", "Attract natural predators like birds and parasitic wasps"],
                link: "https://www.almanac.com/pest/armyworms-how-get-rid-lawn-pest"
            },
            {
                name: "Asparagus Bugs",
                type: "Insect",
                plants: ["Asparagus"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Yellowing foliage", "Distorted or curled foliage", "Bent or scarred spears", "Tiny black eggs on spears"],
                prevention: ["Remove plant debris after harvest", "Encourage beneficial insects", "Rotate crops away from asparagus beds"],
                control: ["Handpick beetles and larvae", "Use neem oil or insecticidal soap", "Apply sprays if infestation is severe"],
                link: "n/a"
            },
            {
                name: "Aster Yellows",
                type: "Disease (Phytoplasma, spread by leafhoppers)",
                plants: ["Asters", "Black-eyed Susans", "Carrots", "Celery", "Coneflowers", "Daisies", "Lettuce", "Potatoes", "Tomatoes", "Zinnias"],
                affectedParts: ["Leaves", "Stems", "Fruit/Vegetable", "Flowers"],
                symptoms: ["Yellowing or discolored leaves", "Curling or distorted leaves", "Weak or spindly growth", "Witch's broom (multiple small stems or shoots may emerge from a single point)", "Deformed carrots", "Deformed flowers", "Pale or green or leaflike flowers", "Sterility"],
                prevention: ["Eliminate nearby weeds", "Use resistant varieties", "Monitor and manage leafhopper populations early"],
                control: ["Remove infected plants immediately", "Control leafhoppers with floating row covers or insecticidal soap"],
                link: "n/a"
            },
            {
                name: "Black (Itersonilia) canker",
                type: "Disease (Fungal)",
                plants: ["Asters", "Carrots", "Chrysanthemums", "Coriander", "Parsley", "Parsnips", "Sunflowers"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Dark leaf spots with yellow halos", "Wilting leaves", "Dark sunken cankers", "Dieback of tips or small branches"],
                prevention: ["Rotate crops", "Cover shoulders of root crops like parsnips and carrots with soil to prevent exposure"],
                control: ["Deep plowing to bury infected debris", "Control carrot rust fly"],
                link: ""
            },
            {
                name: "Black Root Rot",
                type: "Disease (Fungal)",
                plants: ["Geraniums", "Hollies", "Pansies", "Petunias", "Vincas"],
                affectedParts: ["Leaves", "Stems", "Roots"],
                symptoms: ["Yellowing leaves", "Wilting leaves", "Stunted growth", "Weak or spindly growth", "Dark or blackened roots", "Rotted or decayed roots"],
                prevention: ["Ensure good drainage", "Avoid overwatering", "Maintain soil pH below 5.5", "Reduce plant stress", "Control fungus gnats and other vectors"],
                control: ["Destroy infected plants", "Remove contaminated soil", "Sanitize tools and containers"],
                link: "n/a"
            },
            {
                name: "Blossom-End Rot",
                type: "Disease (Physiological disorder due to calcium deficiency)",
                plants: ["Bell Peppers", "Eggplants", "Tomatoes", "Zucchinis"],
                affectedParts: ["Fruit"],
                symptoms: ["Sunken or dark or leathery spots on blossom end", "Fruit may crack or rot"],
                prevention: ["Maintain consistent watering", "Avoid high nitrogen fertilizers", "Ensure soil pH is around 6.2â€“6.8", "Add calcium only if a deficiency is confirmed by soil test"],
                control: ["Remove affected fruit", "Apply calcium sprays early in fruit development"],
                link: "https://www.almanac.com/pest/blossom-end-rot"
            },
            {
                name: "Cabbage Looper",
                type: "Insect",
                plants: ["Broccoli", "Cabbages", "Cauliflowers", "Kale"],
                affectedParts: ["Leaves"],
                symptoms: ["Chewed or ragged edges", "Holes in leaves", "Missing leaf sections (skeletonized leaves)"],
                prevention: ["Remove plant debris", "Use row covers", "Encourage beneficial insects like parasitic wasps"],
                control: ["Handpick larvae", "Apply Bacillus thuringiensis (Bt) or spinosad to leaves"],
                link: "https://www.almanac.com/pest/how-get-rid-cabbage-loopers"
            },
            {
                name: "Cabbage Maggots",
                type: "Insect",
                plants: ["Broccoli", "Brussels Sprouts", "Cabbages", "Cauliflowers", "Radishes", "Turnips"],
                affectedParts: ["Leaves", "Stems", "Roots"],
                symptoms: ["Yellowing leaves", "Wilting leaves", "Stunted growth", "Weak or spindly growth", "Darkened or decayed roots", "Stunted roots", "Tunnels in roots", "Small maggots feeding inside roots"],
                prevention: ["Plant late", "Use row covers", "Rotate crops", "Destroy infected plants", "Avoid fresh manure in spring", "No insecticides available"],
                control: ["No effective treatment once damage is visible", "Remove and destroy infected plants", "Use floating row covers to prevent egg-laying"],
                link: "https://www.almanac.com/pest/cabbage-root-maggots"
            },
            {
                name: "Cabbage Worms",
                type: "Insect",
                plants: ["Broccoli", "Brussels Sprouts", "Cabbages", "Cauliflowers", "Radishes", "Turnips"],
                affectedParts: ["Leaves"],
                symptoms: ["Chewed or ragged edges", "Holes in leaves"],
                prevention: ["Grow companion plants (e.g., thyme)", "Invite beneficial insects", "Maintain garden hygiene"],
                control: ["Handpick worms", "Apply Bacillus thuringiensis (Bt), spinosad, or insecticidal soap", "Use row covers"],
                link: "https://www.almanac.com/pest/cabbage-worms"
            },
            {
                name: "Carrot Rust Flies",
                type: "Insect",
                plants: ["Carrots", "Celeriacs", "Celery", "Chervils", "Parsley", "Parsnips"],
                affectedParts: ["Leaves", "Roots"],
                symptoms: ["Yellowing leaves", "Wilting leaves", "Stunted growth", "Rust-colored tunnels", "Scarring on root surface", "Rotting or misshapen roots"],
                prevention: ["Delay planting until after peak fly emergence", "Rotate crops yearly to non-host species", "Avoid planting near wild carrot or weeds", "Harvest carrots as soon as mature", "Remove all crop residue"],
                control: ["Discard infested roots", "Use floating row covers to prevent adult flies from laying eggs"],
                link: ""
            },
            {
                name: "Colorado Potato Beetles",
                type: "Insect",
                plants: ["Eggplants", "Potatoes", "Tomatillos", "Tomatoes"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Skeletonized leaves", "Chewed edges", "Defoliation (loss of leaves)", "Weakened stems", "Chewing damage"],
                prevention: ["Rotate crops", "Remove weeds and alternate host plants like ground cherry and nightshade", "Apply straw mulch", "Use row covers to exclude beetles"],
                control: ["Handpick and drop in soapy water", "Lady beetles prey on eggs", "Apply Beauveria bassiana or spinosad to kill larvae and adults"],
                link: "https://www.almanac.com/pest/colorado-potato-beetles"
            },
            {
                name: "Corn Earworms",
                type: "Insect",
                plants: ["Beans", "Corn", "Cotton", "Peppers", "Sorghums", "Tomatoes"],
                affectedParts: ["Leaves", "Fruit", "Buds"],
                symptoms: ["Ragged feeding on young leaves", "Small holes in foliage", "Chewed kernels at ear tips", "Frass (caterpillar droppings) inside husks", "Damage to tassels or silks", "Silks clipped or chewed"],
                prevention: ["Avoid planting near large cornfields (attracts moths)", "Use early-maturing varieties to escape peak infestation", "Encourage beneficial insects (lacewings, pirate bugs)", "Monitor with pheromone traps to time interventions"],
                control: ["Apply Bacillus thuringiensis (Bt) to silks during early silk stage", "Use spinosad or insecticidal soap", "Handpick larvae if visible"],
                link: "n/a"
            },
            {
                name: "Tomato Cracking",
                type: "Abiotic",
                plants: ["Tomatoes"],
                affectedParts: ["Fruit"],
                symptoms: ["Circular cracks around the stem end (concentric cracking)", "Long splits down the sides (radial cracking)"],
                prevention: ["Regular, deep watering instead of letting it dry out completely", "Mulch with 2 to 3 inch layer of straw, shredded leaves, or compost", "Choose crack-resistant varieties", "Harvest promptly"],
                control: ["Harvest early to prevent rot", "Still edible but use quickly", "If deeply cracked, toss and compost"],
                link: "https://www.almanac.com/video/top-10-tomato-problems-and-solutions"
            },
            {
                name: "Crows",
                type: "Animal",
                plants: ["Apples", "Cherries", "Corn", "Melons", "Pumpkins", "Sorghums", "Sunflowers"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Roots"],
                symptoms: ["Torn or pecked leaves", "Broken young stems from pulling seedlings", "Pecked, torn, or missing kernels/berries, often with large chunks removed", "Uprooted seedlings pulled from soil while foraging"],
                prevention: ["Rotate crops", "Maintain clean fields", "Avoid planting vulnerable crops near roosting areas", "Use resistant or less attractive crop varieties when available"],
                control: ["Exclude with netting or monofilament lines", "Use scare devices (noise makers, reflective tape, predator decoys)", "Thin roost trees to reduce congregation"],
                link: "https://www.almanac.com/pest/crows"
            },
            {
                name: "Cucumber Beetles (Striped)",
                type: "Insect",
                plants: ["Beans", "Cantaloupes", "Corn", "Cucumbers", "Melons", "Squashes", "Watermelons", "Zucchinis"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Flowers"],
                symptoms: ["Small holes, ragged edges, yellow or stippling", "Weakened shoots, feeding scars, sometimes girdling young stems", "Scarred fruit, small feeding holes, surface blemishes", "Damaged petals, feeding on pollen"],
                prevention: ["Remove debris and alternate host plants", "Mulch with thick straw", "Use row covers before flowering", "Monitor for bacterial wilt"],
                control: ["Use floating row covers until flowering", "Handpick beetles", "Apply neem oil or pyrethrin if needed"],
                link: "https://www.almanac.com/pest/cucumber-beetles"
            },
            {
                name: "Cutworms",
                type: "Insect (Larvae of moths)",
                plants: ["Asparagus", "Beans", "Cabbages", "Carrots", "Celery", "Corn", "Lettuce", "Peas", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Chewed or missing leaves near ground level, ragged edges", "Seedlings cut off at soil line, damaged young stems"],
                prevention: ["Wrap a 4-inch-wide collar made from cardboard/newspaper around each seedling stem", "Weed", "Remove plant debris", "Row covers"],
                control: ["Hand-pick larvae at night", "Use cardboard collars around stems", "Sprinkle diatomaceous earth or crushed eggshells around base", "Apply biological insecticides like Spinosad or Bt if needed"],
                link: "https://www.almanac.com/pest/cutworms"
            },
            {
                name: "Damping Off",
                type: "Disease (Fungal or Oomycete)",
                plants: ["Basil", "Broccoli", "Cabbages", "Cauliflowers", "Celery", "Cucumbers", "Lettuce", "Melons", "Peppers", "Spinach", "Tomatoes"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Yellowing leaves", "Wilting leaves", "Seedlings topple over, stem collapse"],
                prevention: ["Sanitize trays and tools", "Use sterile potting mix", "Avoid overwatering", "Provide good air circulation and bottom heat"],
                control: ["Improve drainage", "Use sterile potting mix", "Avoid overwatering", "Apply biological fungicides like Trichoderma or Bacillus subtilis if needed"],
                link: "n/a"
            },
            {
                name: "Deer",
                type: "Animal",
                plants: ["Apples", "Beans", "Cherries", "Corn", "Hostas", "Lettuce", "Peas", "Roses", "Spinach", "Sunflowers", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Buds", "Flowers"],
                symptoms: ["Torn or eaten leaves, ragged edges", "Broken or stripped stems, damaged shoots", "Partially eaten or missing fruit", "Nipped or eaten buds", "Eaten or damaged flowers"],
                prevention: ["Avoid planting deer favorites in exposed areas", "Use resistant varieties", "Rotate plantings", "Maintain clean fields"],
                control: ["Install fencing or netting", "Use scare devices", "Apply natural repellents like garlic or hot pepper sprays"],
                link: "https://www.almanac.com/pest/how-keep-deer-out-garden"
            },
            {
                name: "Downy Mildew",
                type: "Disease",
                plants: ["Basil", "Broccoli", "Cucumbers", "Grapes", "Lettuce", "Melons", "Onions", "Peas", "Roses", "Spinach", "Sunflowers"],
                affectedParts: ["Leaves"],
                symptoms: ["Yellow spots on upper leaf surface", "Gray or bluish fuzzy growth on undersides", "Leaf distortion", "Premature leaf drop"],
                prevention: ["Space plants for airflow", "Use resistant varieties", "Avoid wet foliage", "Rotate crops away from susceptible hosts"],
                control: ["Remove infected plants", "Apply fungicides early and rotate modes of action", "Avoid overhead irrigation"],
                link: "https://www.almanac.com/pest/downy-mildew"
            },
            {
                name: "Early Blight",
                type: "Disease",
                plants: ["Eggplants", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Brown leaf spots with concentric rings", "Yellow halos", "Lower leaves die first", "Stem lesions", "Fruit rot near stem end"],
                prevention: ["Rotate crops", "Mulch to reduce soil splash", "Avoid overhead watering", "Plant tolerant varieties"],
                control: ["Remove infected leaves", "Apply organic-approved fungicides like copper sprays early", "Prune for airflow"],
                link: "https://www.almanac.com/pest/early-blight"
            },
            {
                name: "Earwigs",
                type: "Insect",
                plants: ["Basil", "Corn", "Dahlias", "Lettuce", "Marigolds", "Spinach", "Strawberries", "Tomatoes"],
                affectedParts: ["Leaves", "Flowers", "Fruit"],
                symptoms: ["Small holes, ragged edges", "Damaged petals, chewed flower parts", "Surface blemishes, small holes"],
                prevention: ["Remove plant debris", "Reduce moisture", "Trim vegetation", "Avoid overwatering", "Seal cracks and crevices", "Encourage natural predators like birds and frogs"],
                control: ["Trap in tuna can filled with Â½ inch of fish oil, sunk in soil with rim slightly above ground", "Rolled damp newspaper traps", "Apply diatomaceous earth around plants"],
                link: "https://www.almanac.com/pest/earwigs"
            },
            {
                name: "Fire Ants",
                type: "Insect",
                plants: ["Beans", "Okra", "Peanuts", "Potatoes", "Sunflowers", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Roots"],
                symptoms: ["Mounds near crops", "Stunted seedlings", "Chewed stems", "Ants protecting aphids", "Painful stings during harvest"],
                prevention: ["Use bait in spring and fall", "Manage adjacent lawn populations", "Avoid overwatering", "Monitor with greasy bait tests like potato chips"],
                control: ["Use granular baits and drenches labeled for organic use"],
                link: "https://www.almanac.com/pest/how-get-rid-fire-ants-immediately"
            },
            {
                name: "Fire Blight",
                type: "Disease (Bacterial)",
                plants: ["Apples", "Crabapples", "Hawthorns", "Pears", "Quinces", "Roses"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Flowers"],
                symptoms: ["Blackened leaves, scorched appearance", "Blackened shoots, shepherd's crook bending", "Shriveled, blackened fruit", "Blossoms turn brown or black, wilt"],
                prevention: ["Plant resistant varieties", "Avoid high nitrogen", "Prune only in dry weather", "Sanitize tools"],
                control: ["Prune 8â€“12 inches below infection during dormancy", "Sanitation is critical", "Sterilize tools between cuts", "Apply copper sprays during bloom"],
                link: "https://www.almanac.com/pest/how-identify-and-manage-fire-blight"
            },
            {
                name: "Flea Beetles",
                type: "Insect",
                plants: ["Broccoli", "Cabbages", "Eggplants", "Kale", "Peppers", "Radishes", "Tomatoes", "Turnips"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Small round holes (shot holes), stippling", "Feeding scars on young stems"],
                prevention: ["Mulch heavily", "Attract beneficial insects like braconid wasps", "Use row covers or fine screening during seedling stage", "Plant late", "Remove weeds and plant debris"],
                control: ["Hand-vacuum adults off leaves", "Use white sticky traps", "Apply neem oil or insecticidal soap"],
                link: "https://www.almanac.com/pest/flea-beetles"
            },
            {
                name: "Fungus Gnats",
                type: "Insect",
                plants: ["Houseplants", "Ornamentals", "Potted Herbs", "Seedlings"],
                affectedParts: ["Leaves", "Roots"],
                symptoms: ["Yellowing leaves", "Stunted growth", "Root damage, decay"],
                prevention: ["Let soil dry between watering", "Avoid overwatering", "Use sterile potting mix", "Remove decaying organic matter"],
                control: ["Destroy severely infested plants (DNC)", "Apply Bacillus thuringiensis israelensis (BTi) or beneficial nematodes", "Reduce watering"],
                link: "https://www.almanac.com/pest/fungus-gnats"
            },
            {
                name: "Fusarium Wilt",
                type: "Disease (Fungal)",
                plants: ["Beans", "Eggplants", "Lettuce", "Peppers", "Tomatoes", "Watermelons"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Yellowing leaves, often one-sided", "Wilting leaves, especially during heat", "Brown discoloration inside stems"],
                prevention: ["Use resistant varieties (check race resistance)", "Rotate with non-host crops", "Sanitize tools and equipment"],
                control: ["Remove infected plants", "Avoid replanting susceptible crops", "Resistant varieties"],
                link: "https://www.almanac.com/pest/fusarium-wilt"
            },
            {
                name: "Gray Mold (Botrytis)",
                type: "Disease (Fungal)",
                plants: ["Beans", "Geraniums", "Lettuce", "Peonies", "Roses", "Strawberries", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Flowers"],
                symptoms: ["Gray fuzzy growth on leaves", "Gray fuzzy growth on stems, cankers", "Gray fuzzy growth on fruit, rot", "Gray fuzzy growth on flowers, blight"],
                prevention: ["Avoid overhead watering", "Increase spacing and airflow", "Remove spent flowers and debris", "Irrigate early in the day"],
                control: ["Remove infected tissue", "Apply copper-based fungicides or biofungicides like Bacillus subtilis early", "Refrigerate harvested produce properly"],
                link: "https://www.almanac.com/pest/gray-mold-or-botrytis"
            },
            {
                name: "Groundhogs",
                type: "Animal",
                plants: ["Beans", "Carrots", "Lettuce", "Peas", "Squashes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit", "Roots"],
                symptoms: ["Eaten or missing leaves", "Chewed or broken stems", "Partially eaten fruit", "Chewed or dug-up roots"],
                prevention: ["Fence garden with 4-ft wire buried 12 inches", "Add electric wire at top", "Remove nearby brush piles and burrow sites"],
                control: ["Use live traps with fruit bait", "Install buried fencing with L-shaped barrier"],
                link: "https://www.almanac.com/pest/groundhogs"
            },
            {
                name: "Halo Blight",
                type: "Disease (Bacterial)",
                plants: ["Beans (Snap, Dry, Lima)"],
                affectedParts: ["Leaves", "Stems", "Pods"],
                symptoms: ["Small water-soaked leaf spots with yellow halos", "Lesions on stems", "Water-soaked spots on pods, may ooze bacteria"],
                prevention: ["Choose blight resistant varieties", "Use row covers", "Use certified disease-free seed", "Rotate with non-legumes", "Avoid overhead irrigation", "Sanitize tools"],
                control: ["Remove infected debris", "Apply copper sprays preventively", "Avoid working in wet fields"],
                link: "n/a"
            },
            {
                name: "Japanese Beetles",
                type: "Insect",
                plants: ["Apples", "Beans", "Cherries", "Corn", "Grapes", "Linden Trees", "Peaches", "Plums", "Raspberries", "Roses"],
                affectedParts: ["Leaves", "Flowers", "Fruit"],
                symptoms: ["Skeletonized leaves (eaten between veins)", "Damaged petals, chewed flower parts", "Surface feeding, scarring"],
                prevention: ["Cover plants after fruit set", "Avoid planting beetle-attracting species in problem areas", "Maintain healthy plants", "Delay lawn watering during peak egg-laying season", "Plant resistant varieties"],
                control: ["Start early, handpicking beetles", "Apply neem oil or insecticidal soap early while populations are small", "Apply milky spore or beneficial nematodes to soil"],
                link: "https://www.almanac.com/pest/japanese-beetles"
            },
            {
                name: "Late Blight",
                type: "Disease (Fungal-like)",
                plants: ["Eggplants", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Water-soaked lesions on leaves", "Dark, greasy spots", "White fuzzy growth under leaves in humid conditions", "Fruit rot"],
                prevention: ["Plant earlier in year, select blight resistant varieties", "Use certified seed", "Destroy cull piles and volunteers", "Avoid overhead irrigation", "Monitor weather and apply fungicides preventively"],
                control: ["Remove infected plants immediately", "Apply copper-based fungicides or biofungicides like Bacillus subtilis", "Avoid harvesting until vines are dead for 2â€“3 weeks"],
                link: "https://www.almanac.com/pest/late-blight-disease-tomatoes-and-potatoes-plants"
            },
            {
                name: "Leaf Hoppers",
                type: "Insect",
                plants: ["Apples", "Beans", "Carrots", "Celery", "Dahlias", "Eggplants", "Grapes", "Lettuce", "Ornamentals", "Peas", "Potatoes", "Roses", "Strawberries"],
                affectedParts: ["Leaves"],
                symptoms: ["Stippling (tiny white or yellow dots)", "Curling or cupping", "Yellowing or browning (hopperburn)", "Stunted growth"],
                prevention: ["Use row covers early in season", "Rotate crops", "Attract beneficial insects (ladybugs, lacewings)", "Avoid over-fertilizing", "Maintain garden hygiene"],
                control: ["Knock nymphs off with strong water spray", "Spray insecticidal soap or pyrethrin", "Release beneficial insects", "Remove infested leaves", "Apply kaolin clay as a deterrent"],
                link: "https://www.almanac.com/pest/leafhoppers"
            },
            {
                name: "Leaf Miners",
                type: "Insect",
                plants: ["Beans", "Beets", "Celery", "Chards", "Citruses", "Cucumbers", "Lettuce", "Ornamentals", "Peas", "Spinach", "Tomatoes"],
                affectedParts: ["Leaves"],
                symptoms: ["Squiggly or serpentine trails (mines)", "Blotchy patches (blotch mines)", "Premature leaf drop", "Reduced photosynthesis"],
                prevention: ["Use row covers early", "Remove and destroy infested leaves", "Avoid over-fertilizing", "Plant trap crops nearby"],
                control: ["Prune damaged foliage", "Apply neem oil", "Release parasitic wasps"],
                link: "https://www.almanac.com/pest/leaf-miners"
            },
            {
                name: "Leaf Spot",
                type: "Disease (Fungal or bacterial)",
                plants: ["Beans", "Corn", "Cucumbers", "Lettuce", "Peppers", "Roses", "Shrubs", "Tomatoes", "Trees"],
                affectedParts: ["Leaves"],
                symptoms: ["Circular or angular spots", "Spots may have dark margins or halos", "Spots may fall out leaving holes (shot hole)", "Yellowing around spots"],
                prevention: ["Rotate crops", "Avoid overhead watering", "Mulch properly", "Space plants well", "Plant resistant varieties"],
                control: ["Remove fallen leaves and plant debris", "Apply copper-based fungicides early", "Prune for airflow"],
                link: "n/a"
            },
            {
                name: "Mexican Bean Beetles",
                type: "Insect",
                plants: ["Lima Beans", "Snap beans", "Soybeans"],
                affectedParts: ["Leaves"],
                symptoms: ["Skeletonized leaves (lacy appearance)", "Yellow or bronze discoloration"],
                prevention: ["Row covers after planting (through harvest)", "Crush egg masses by hand", "Spray Neem"],
                control: ["Handpick", "Purchase and release beneficial wasp Pediobius foveolatus when larvae are observed", "Destroy severely infested plants"],
                link: "https://www.almanac.com/pest/mexican-bean-beetles"
            },
            {
                name: "Mice",
                type: "Animal",
                plants: ["Bulbs", "Fruit trees", "Houseplants", "Ornamentals", "Vegetables"],
                affectedParts: ["Leaves", "Stems", "Roots", "Bark"],
                symptoms: ["Chewed leaves or stems", "Gnawed bark at base of trees or shrubs", "Chewed or dug-up roots", "Uprooted seedlings"],
                prevention: ["Keep garden tidy", "Seal compost bins", "Avoid mulch piles near crops", "Use wire mesh around trunks"],
                control: ["Use bait stations or traps", "Install tree guards", "Remove sheltering debris"],
                link: "https://www.almanac.com/pest/mice"
            },
            {
                name: "Moles",
                type: "Animal",
                plants: ["Bulbs", "Lawns", "Root crops", "Seedlings"],
                affectedParts: ["Roots"],
                symptoms: ["Raised ridges or tunnels in lawn", "Molehills (mounds of soil)", "Uprooted plants", "Disturbed roots"],
                prevention: ["Maintain healthy soil", "Reduce grub populations only if needed", "Avoid overwatering", "Tolerate minor mole activity if possible"],
                control: ["Traps", "Install underground mesh in raised beds", "Avoid ineffective repellents"],
                link: "https://www.almanac.com/pest/moles"
            },
            {
                name: "Mosaic Virus",
                type: "Disease (Viral)",
                plants: ["Beans", "Cucumbers", "Eggplants", "Lettuce", "Melons", "Peppers", "Potatoes", "Roses", "Spinach", "Squashes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Mottled yellow and green patterns", "Distorted or curled leaves", "Stunted growth", "Reduced yield", "Misshapen fruit"],
                prevention: ["Remove infected plants", "Control aphids with insecticidal soap or reflective mulches", "Sanitize tools between uses to prevent spread", "Use certified virus-free seeds and resistant varieties"],
                control: ["There is no cure for Mosaic Virus", "Infected plants must be removed and destroyed to prevent spread"],
                link: "https://www.almanac.com/pest/mosaic-viruses"
            },
            {
                name: "Onion Maggots",
                type: "Insect",
                plants: ["Chives", "Garlic", "Leeks", "Onions", "Shallots"],
                affectedParts: ["Leaves", "Roots", "Bulbs"],
                symptoms: ["Wilting or yellowing leaves", "Stunted growth", "Rotting bulbs", "Maggots present in bulbs"],
                prevention: ["Rotate crops", "Use row covers", "Remove plant debris", "Avoid planting in cool, wet soil"],
                control: ["No effective treatment once bulbs are infested", "Discard affected plants", "Apply beneficial nematodes preemptively", "Use insecticidal seed treatments before planting"],
                link: "N/a but often grouped with Cabbage Maggots. Should we rename?"
            },
            {
                name: "Powdery Mildew",
                type: "Disease (Fungal)",
                plants: ["Beans", "Cucumbers", "Eggplants", "Grapes", "Lettuce", "Melons", "Peas", "Peppers", "Roses", "Squashes", "Tomatoes", "Zinnias"],
                affectedParts: ["Leaves", "Stems", "Flowers", "Fruit"],
                symptoms: ["White or gray powdery coating", "Distorted or curled leaves", "Yellowing leaves", "Premature leaf drop", "Reduced flowering or fruiting"],
                prevention: ["Improve air circulation: Space plants properly and prune dense growth", "Choose sunny spots: Shade encourages mildew", "Use resistant varieties: Especially for squash, cucumbers, and roses", "Clean up debris: Remove infected leaves and fallen plant matter"],
                control: ["Apply fungicides such as neem oil, sulfur, potassium bicarbonate, or horticultural oils", "DIY spray: Mix 1 tbsp baking soda + 1 tsp dish soap + 1 tbsp vegetable oil in 1 gallon water", "Prune infected parts and dispose of themâ€”do not compost"],
                link: "https://www.almanac.com/pest/powdery-mildew"
            },
            {
                name: "Rabbits",
                type: "Animal",
                plants: ["Beans", "Lettuce", "Peas", "Roses", "Shrubs", "Trees", "Vegetables"],
                affectedParts: ["Leaves", "Stems", "Bark"],
                symptoms: ["Clean-cut damage at 45-degree angle", "Gnawed bark, especially on young trees", "Droppings (small round pellets) nearby"],
                prevention: ["Fence garden with 2-ft wire mesh buried 6 inches", "Use tree guards", "Remove brush piles"],
                control: ["Use repellents like blood meal or garlic spray", "Install motion-activated sprinklers"],
                link: "https://www.almanac.com/pest/rabbits"
            },
            {
                name: "Raccoons",
                type: "Animal",
                plants: ["Berries", "Corn", "Grapes", "Melons", "Strawberries"],
                affectedParts: ["Fruit"],
                symptoms: ["Partially eaten fruit", "Torn or pulled-apart husks on corn", "Overturned plants or containers"],
                prevention: ["Harvest ripe fruit promptly", "Secure compost and garbage", "Install electric fencing"],
                control: ["Use motion-activated lights or sprinklers", "Apply repellents like capsaicin spray"],
                link: "https://www.almanac.com/pest/raccoons"
            },
            {
                name: "Root Knot Nematodes",
                type: "Nematode",
                plants: ["Beans", "Carrots", "Cucumbers", "Lettuce", "Melons", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Roots"],
                symptoms: ["Galls or knots on roots", "Stunted growth", "Yellowing leaves", "Wilting", "Reduced yield"],
                prevention: ["Rotate with resistant crops (corn, grains)", "Solarize soil", "Add organic matter", "Use resistant varieties"],
                control: ["Apply beneficial nematodes or fungi", "Remove and destroy infected plants", "Avoid spreading contaminated soil"],
                link: "https://www.almanac.com/pest/root-knot-nematodes"
            },
            {
                name: "Rust",
                type: "Disease (Fungal)",
                plants: ["Asparagus", "Beans", "Corn", "Hollyhocks", "Roses", "Snapdragons", "Sunflowers"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Orange, yellow, or brown pustules", "Powdery spores that rub off", "Yellowing or browning of leaves", "Premature defoliation"],
                prevention: ["Space plants for airflow", "Water at base", "Remove infected debris", "Plant resistant varieties"],
                control: ["Remove infected leaves", "Apply sulfur or copper-based fungicides early", "Avoid overhead irrigation"],
                link: "https://www.almanac.com/pest/rust-plant-disease"
            },
            {
                name: "Scale Insects",
                type: "Insect",
                plants: ["Apples", "Azaleas", "Citruses", "Hollies", "Magnolias", "Oaks", "Roses", "Shrubs", "Trees"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Small, immobile bumps on leaves or stems", "Yellowing leaves", "Sticky honeydew", "Sooty mold growth"],
                prevention: ["Prune infested branches", "Encourage natural predators", "Avoid over-fertilizing"],
                control: ["Scrape off scales", "Apply horticultural oil during dormancy", "Use insecticidal soap", "Release ladybugs"],
                link: "https://www.almanac.com/pest/scale-insects"
            },
            {
                name: "Slugs and Snails",
                type: "Mollusk",
                plants: ["Basil", "Cabbages", "Hostas", "Lettuce", "Marigolds", "Strawberries", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Large, irregular holes in leaves", "Silvery slime trails", "Chewed stems", "Damage to fruit at soil level"],
                prevention: ["Remove hiding places", "Water in morning", "Use copper barriers", "Encourage predators"],
                control: ["Handpick at night", "Use beer traps", "Apply iron phosphate bait", "Sprinkle diatomaceous earth"],
                link: "https://www.almanac.com/pest/slugs-and-snails"
            },
            {
                name: "Spider Mites",
                type: "Arachnid",
                plants: ["Beans", "Cucumbers", "Eggplants", "Houseplants", "Roses", "Strawberries", "Tomatoes"],
                affectedParts: ["Leaves"],
                symptoms: ["Fine webbing on undersides of leaves", "Stippling (tiny yellow dots)", "Bronzing or yellowing of leaves", "Leaf drop"],
                prevention: ["Increase humidity", "Avoid dusty conditions", "Monitor regularly", "Remove weeds"],
                control: ["Spray with water", "Apply insecticidal soap or neem oil", "Release predatory mites"],
                link: "https://www.almanac.com/pest/spider-mites"
            },
            {
                name: "Squash Bugs",
                type: "Insect",
                plants: ["Cucumbers", "Melons", "Pumpkins", "Squashes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Yellow spots that turn brown", "Wilting", "Stunted growth", "Frass on leaves"],
                prevention: ["Use row covers", "Remove plant debris", "Handpick eggs", "Plant resistant varieties"],
                control: ["Trap under boards", "Apply neem oil", "Use insecticidal soap", "Remove heavily infested plants"],
                link: "https://www.almanac.com/pest/squash-bugs"
            },
            {
                name: "Squash Vine Borers",
                type: "Insect",
                plants: ["Cucumbers", "Pumpkins", "Squashes", "Zucchinis"],
                affectedParts: ["Stems"],
                symptoms: ["Sudden wilting", "Sawdust-like frass at base of stems", "Holes in stems", "Yellow eggs on stems"],
                prevention: ["Use row covers", "Plant late", "Choose resistant varieties", "Rotate crops"],
                control: ["Slit stems to remove borers", "Inject Bt into stems", "Remove and destroy infested plants"],
                link: "https://www.almanac.com/pest/squash-vine-borer"
            },
            {
                name: "Squirrels",
                type: "Animal",
                plants: ["Bulbs", "Corn", "Fruit trees", "Sunflowers", "Tomatoes"],
                affectedParts: ["Fruit", "Bulbs", "Seeds"],
                symptoms: ["Partially eaten fruit", "Dug-up bulbs", "Chewed or stripped seed heads"],
                prevention: ["Harvest promptly", "Use baffles on poles", "Net fruit trees", "Plant daffodils (squirrel-resistant)"],
                control: ["Use motion-activated sprinklers", "Apply hot pepper spray", "Provide alternative food sources"],
                link: "https://www.almanac.com/pest/squirrels"
            },
            {
                name: "Stink Bugs",
                type: "Insect",
                plants: ["Apples", "Beans", "Corn", "Peppers", "Squashes", "Tomatoes"],
                affectedParts: ["Fruit"],
                symptoms: ["Cat-facing (dimples or distortions)", "Sunken or discolored areas", "Hard, white spots under skin"],
                prevention: ["Remove weeds", "Use row covers", "Handpick adults", "Plant trap crops"],
                control: ["Knock into soapy water", "Apply insecticidal soap", "Use neem oil", "Encourage predators"],
                link: "https://www.almanac.com/pest/stink-bugs"
            },
            {
                name: "Sunscald",
                type: "Abiotic",
                plants: ["Fruit trees", "Peppers", "Tomatoes"],
                affectedParts: ["Fruit", "Bark"],
                symptoms: ["White or pale patches on fruit", "Soft, sunken areas", "Blistered or cracked bark on trees"],
                prevention: ["Provide afternoon shade", "Avoid excessive pruning", "Use whitewash on trunks", "Harvest promptly"],
                control: ["Remove affected fruit", "Protect with shade cloth", "Wrap young tree trunks"],
                link: "n/a"
            },
            {
                name: "Thrips",
                type: "Insect",
                plants: ["Garlic", "Gladioli", "Irises", "Onions", "Peppers", "Roses", "Tomatoes"],
                affectedParts: ["Leaves", "Flowers", "Fruit"],
                symptoms: ["Silvery streaks or speckling", "Deformed flowers", "Scarring on fruit", "Black specks (frass)"],
                prevention: ["Use row covers", "Remove weeds", "Avoid over-fertilizing", "Monitor regularly"],
                control: ["Spray with water", "Apply insecticidal soap", "Use neem oil", "Release predatory mites"],
                link: "https://www.almanac.com/pest/thrips"
            },
            {
                name: "Tomato Hornworms",
                type: "Insect",
                plants: ["Eggplants", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruit"],
                symptoms: ["Chewed or missing leaves", "Large green caterpillars with horns", "Frass (droppings) on leaves", "Damage to fruit"],
                prevention: ["Use floating row covers early in season", "Rotate crops and avoid planting near previous nightshade beds", "Add native plants to attract beneficial insects", "Grow dill as a trap crop", "Plant basil or marigolds as repellents"],
                control: ["Handpick hornworms (wear gloves)", "Leave parasitized larvae with white cocoons", "Spray Bacillus thuringiensis (Bt) on young caterpillars", "Prune heavily infested branches"],
                link: "https://www.almanac.com/pest/tomato-hornworms"
            },
            {
                name: "Verticillium Wilt",
                type: "Disease (Fungal)",
                plants: ["Eggplants", "Maple trees", "Peppers", "Potatoes", "Strawberries", "Tomatoes"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Yellowing between veins or on leaf margins", "Wilting, especially during heat of day", "Brown streaking in vascular tissue", "Stunted growth"],
                prevention: ["Plant resistant varieties", "Rotate crops", "Solarize soil", "Avoid susceptible plants"],
                control: ["Remove infected plants", "Fumigate soil if severe", "Use resistant rootstocks"],
                link: "https://www.almanac.com/pest/verticillium-wilt"
            },
            {
                name: "Whiteflies",
                type: "Insect",
                plants: ["Cabbages", "Citruses", "Cucumbers", "Peppers", "Poinsettias", "Tomatoes"],
                affectedParts: ["Leaves"],
                symptoms: ["Cloud of tiny white insects when disturbed", "Yellowing leaves", "Sticky honeydew", "Sooty mold growth"],
                prevention: ["Use row covers", "Remove weeds", "Monitor regularly", "Avoid over-fertilizing"],
                control: ["Spray with water", "Apply insecticidal soap", "Use yellow sticky traps", "Release beneficial insects"],
                link: "https://www.almanac.com/pest/whiteflies"
            },
            {
                name: "White Mold",
                type: "Disease (Fungal)",
                plants: ["Beans", "Lettuce", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Stems", "Leaves", "Fruit"],
                symptoms: ["White cottony growth", "Water-soaked lesions", "Wilting", "Sclerotia (black structures)"],
                prevention: ["Space plants", "Improve airflow", "Avoid overhead watering", "Rotate crops"],
                control: ["Remove infected plants", "Apply fungicides early", "Solarize soil"],
                link: "n/a"
            },
            {
                name: "Wireworms",
                type: "Insect",
                plants: ["Beans", "Carrots", "Corn", "Potatoes", "Wheat"],
                affectedParts: ["Roots", "Tubers", "Seeds"],
                symptoms: ["Tunnels in roots or tubers", "Wilting", "Poor germination", "Holes in tubers"],
                prevention: ["Rotate crops", "Till soil", "Use bait traps", "Plant later in season"],
                control: ["Apply beneficial nematodes", "Use insecticidal treatments", "Remove infested plants"],
                link: "https://www.almanac.com/pest/wireworms"
            }
        ];

        // Function to create and inject the CSS
        function injectStyles() {
            const style = document.createElement('style');
            style.textContent = `
                #CalculatorContainer * {
                    box-sizing: border-box;
                    margin: 0;
                    padding: 0;
                    font-family: 'Georgia', serif; 
                }
                
                #CalculatorContainer body {
                    background-color: #fff;
                    color: #333;
                    line-height: 1.6;
                    padding: 20px;
                }
                
                #CalculatorContainer .container {
                    max-width: 1000px;
                    margin: 0 auto;
                    background: #f9f5e8;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    padding: 30px;
                }
                
                #CalculatorContainer header {
                    text-align: center;
                    margin-bottom: 30px;
                    padding-bottom: 20px;
                    border-bottom: 2px solid #ddd4d4;
                }
                
                #CalculatorContainer h1 {
                    color: #ad2a24;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .description {
                    color: #666;
                    font-size: 16px;
                    max-width: 800px;
                    margin: 0 auto;
                }
                
                #CalculatorContainer .step {
                    margin-bottom: 25px;
                    padding: 20px;
                    background: #fff;
                    border-radius: 8px;
                }
                
                #CalculatorContainer .step-title {
                    font-size: 18px;
                    font-weight: 600;
                    margin-bottom: 15px;
                    color: #af6b35;
                }
                
                #CalculatorContainer .form-group {
                    margin-bottom: 15px;
                }
                
                #CalculatorContainer label {
                    display: block;
                    margin-bottom: 8px;
                    font-weight: 500;
                    color: #555;
                }
                
                #CalculatorContainer select {
                    width: 100%;
                    padding: 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    font-size: 16px;
                    background-color: white;
                    transition: border-color 0.3s;
                }
                
                #CalculatorContainer select:focus {
                    outline: none;
                    border-color: #dfebe0;
                    box-shadow: 0 0 0 2px rgba(220, 104, 89, 0.2);
                }
                
                #CalculatorContainer .symptoms-container {
                    max-height: 300px;
                    overflow-y: auto;
                    padding: 10px;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                }
                
                #CalculatorContainer .symptom-option {
                    padding: 10px;
                    border: 1px solid #eee;
                    border-radius: 4px;
                    margin-bottom: 8px;
                    display: flex;
                    align-items: center;
                    transition: background-color 0.2s;
                }
                
                #CalculatorContainer .symptom-option:hover {
                    background: #f5f5f5;
                }
                
                #CalculatorContainer .symptom-option input[type="radio"] {
                    margin-right: 10px;
                    accent-color: #4CAF50;
                }
                
                #CalculatorContainer .symptom-option label {
                    margin-bottom: 0;
                    cursor: pointer;
                    flex-grow: 1;
                }
                
                #CalculatorContainer .result {
                    margin-top: 30px;
                    padding: 20px;
                    background: #fff;
                    border-radius: 8px;
                    display: none;
                }
                
                #CalculatorContainer .result h3 {
                    margin-bottom: 15px;
                    color: #af6b35;
                }
                
                #CalculatorContainer .pest-info {
                    background: white;
                    padding: 15px;
                    border-radius: 6px;
                    margin-bottom: 15px;
                    border: 1px solid #eee;
                }
                
                #CalculatorContainer .pest-name {
                    font-size: 20px;
                    font-weight: 600;
                    color: #ad2a24;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .pest-type {
                    display: inline-block;
                    background: #f9f5e8;;
                    color: #ad2a24;
                    padding: 4px 8px;
                    border-radius: 4px;
                    font-size: 14px;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .pest-detail {
                    margin-bottom: 8px;
                }
                
                #CalculatorContainer .pest-detail strong {
                    color: #555;
                }
                
                #CalculatorContainer .pest-link {
                    display: inline-block;
                    padding: 10px 15px;
                    background: #4CAF50;
                    color: white;
                    text-decoration: none;
                    border-radius: 4px;
                    transition: background 0.3s;
                    margin-top: 10px;
                }
                
                #CalculatorContainer .pest-link:hover {
                    background: #3d8b40;
                }
                
                #CalculatorContainer .reset-btn {
                    display: inline-block;
                    padding: 10px 15px;
                    background: #666;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-top: 15px;
                    transition: background 0.3s;
                }
                
                #CalculatorContainer .reset-btn:hover {
                    background: #555;
                }
                
                #CalculatorContainer .no-results {
                    text-align: center;
                    padding: 20px;
                    color: #666;
                    font-style: italic;
                }
                
                @media (max-width: 768px) {
                    #CalculatorContainer .container {
                        padding: 15px;
                    }
                    
                    #CalculatorContainer .step {
                        padding: 15px;
                    }
                    
                    #CalculatorContainer select {
                        font-size: 16px; /* Prevents zoom on iOS */
                    }
                    
                    #CalculatorContainer .symptoms-container {
                        max-height: 250px;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // Function to create the HTML structure
        function createHTMLStructure() {
            const calculatorContainer = document.getElementById('CalculatorContainer');
            
            calculatorContainer.innerHTML = `
                <div class="container">
                    <header>
                        <h1>Plant Pest Diagnostic Tool</h1>
                        <p class="description">Identify pests and diseases affecting your plants by selecting your plant type, problem area, and symptoms</p>
                    </header>
                    
                    <div class="step">
                        <h2 class="step-title">Step 1: Select a Plant</h2>
                        <div class="form-group">
                            <label for="plant-select">Choose a plant:</label>
                            <select id="plant-select">
                                <option value="">-- Select a plant --</option>
                                <!-- Plant options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="step" id="problem-area-step" style="display: none;">
                        <h2 class="step-title">Step 2: Select Problem Area</h2>
                        <div class="form-group">
                            <label for="problem-area-select">Where is the problem located?</label>
                            <select id="problem-area-select">
                                <option value="">-- Select problem area --</option>
                                <!-- Problem area options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="step" id="symptoms-step" style="display: none;">
                        <h2 class="step-title">Step 3: Select Symptoms</h2>
                        <div class="symptoms-container" id="symptoms-container">
                            <!-- Symptoms will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="result" id="result">
                        <h3>Diagnosis Result</h3>
                        <div class="pest-info" id="pest-info">
                            <!-- Pest information will be populated by JavaScript -->
                        </div>
                        <a href="#" class="pest-link" id="pest-link" target="_blank">Learn More About This Pest</a>
                        <br>
                        <button class="reset-btn" onclick="resetTool()">Start Over</button>
                    </div>
                </div>
            `;
        }

        // Extract all unique plants from pest data
        const allPlants = [...new Set(pestData.flatMap(pest => pest.plants))].sort();

        // DOM elements
        let plantSelectEl, problemAreaStepEl, problemAreaSelectEl, symptomsStepEl, symptomsContainerEl, resultEl, pestInfoEl, pestLinkEl;

        // State variables
        let selectedPlant = null;
        let selectedProblemArea = null;
        let filteredPests = [];

        // Initialize the tool
        function initTool() {
            plantSelectEl = document.getElementById('plant-select');
            problemAreaStepEl = document.getElementById('problem-area-step');
            problemAreaSelectEl = document.getElementById('problem-area-select');
            symptomsStepEl = document.getElementById('symptoms-step');
            symptomsContainerEl = document.getElementById('symptoms-container');
            resultEl = document.getElementById('result');
            pestInfoEl = document.getElementById('pest-info');
            pestLinkEl = document.getElementById('pest-link');

            // Populate plant select options
            allPlants.forEach(plant => {
                const option = document.createElement('option');
                option.value = plant;
                option.textContent = plant;
                plantSelectEl.appendChild(option);
            });

            // Event listeners
            plantSelectEl.addEventListener('change', handlePlantChange);
            problemAreaSelectEl.addEventListener('change', handleProblemAreaChange);
        }

        // Plant change handler
        function handlePlantChange() {
            selectedPlant = plantSelectEl.value;

            if (selectedPlant) {
                problemAreaStepEl.style.display = 'block';
                problemAreaSelectEl.innerHTML = '<option value="">-- Select problem area --</option>';

                let affectedPartsForPlant = [...new Set(pestData
                    .filter(pest => pest.plants.includes(selectedPlant))
                    .flatMap(pest => pest.affectedParts))].sort();

                // Remove duplicates
                affectedPartsForPlant = [...new Set(affectedPartsForPlant)].sort();

                affectedPartsForPlant.forEach(part => {
                    const option = document.createElement('option');
                    option.value = part;
                    option.textContent = part;
                    problemAreaSelectEl.appendChild(option);
                });

                problemAreaStepEl.scrollIntoView({ behavior: 'smooth' });
                symptomsStepEl.style.display = 'none';
                resultEl.style.display = 'none';
                symptomsContainerEl.innerHTML = '';
            } else {
                problemAreaStepEl.style.display = 'none';
                symptomsStepEl.style.display = 'none';
                resultEl.style.display = 'none';
                symptomsContainerEl.innerHTML = '';
            }
        }

        // Problem area change handler
        function handleProblemAreaChange() {
            selectedProblemArea = problemAreaSelectEl.value;

            if (selectedProblemArea) {
                // Filter pests based on selected plant and problem area
                filteredPests = pestData.filter(pest =>
                    pest.plants.includes(selectedPlant) &&
                    pest.affectedParts.includes(selectedProblemArea)
                );

                symptomsStepEl.style.display = 'block';
                symptomsContainerEl.innerHTML = '';

                if (filteredPests.length === 0) {
                    symptomsContainerEl.innerHTML = '<div class="no-results">No symptoms found for this combination.</div>';
                    return;
                }

                // Combine all symptoms from filtered pests and deduplicate
                const allSymptoms = [...new Set(filteredPests.flatMap(pest => pest.symptoms))];
                allSymptoms.sort();

                allSymptoms.forEach(symptom => {
                    const symptomOption = document.createElement('div');
                    symptomOption.className = 'symptom-option';

                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = 'symptom';
                    radio.value = symptom;
                    radio.id = `symptom-${symptom.replace(/\s+/g, '-').toLowerCase()}`;
                    radio.addEventListener('change', () => handleSymptomChange(symptom));

                    const label = document.createElement('label');
                    label.htmlFor = radio.id;
                    label.textContent = symptom;

                    symptomOption.appendChild(radio);
                    symptomOption.appendChild(label);
                    symptomsContainerEl.appendChild(symptomOption);
                });

                symptomsStepEl.scrollIntoView({ behavior: 'smooth' });
                resultEl.style.display = 'none';
                pestInfoEl.innerHTML = '';
                pestLinkEl.style.display = 'none';
            } else {
                symptomsStepEl.style.display = 'none';
                resultEl.style.display = 'none';
                symptomsContainerEl.innerHTML = '';
            }
        }

        // Symptom change handler - find pest(s) for selected symptom and show first pest info
        function handleSymptomChange(selectedSymptom) {
            const matchingPests = filteredPests.filter(pest => pest.symptoms.includes(selectedSymptom));

            if (matchingPests.length > 0) {
                const pest = matchingPests[0]; // Show first matched pest

                pestInfoEl.innerHTML = `
                    <div class="pest-name">${pest.name}</div>
                    <div class="pest-type">${pest.type}</div>
                    <div class="pest-detail"><strong>Plants Affected:</strong> ${pest.plants.join(', ')}</div>
                    <div class="pest-detail"><strong>Affected Parts:</strong> ${pest.affectedParts.join(', ')}</div>
                    <div class="pest-detail"><strong>Symptoms:</strong> ${pest.symptoms.join('; ')}</div>
                    ${pest.prevention ? `<div class="pest-detail"><strong>Prevention:</strong> ${Array.isArray(pest.prevention) ? pest.prevention.join('; ') : pest.prevention}</div>` : ''}
                    ${pest.control ? `<div class="pest-detail"><strong>Control:</strong> ${Array.isArray(pest.control) ? pest.control.join('; ') : pest.control}</div>` : ''}
                `;

                if (pest.link && pest.link !== "n/a") {
                    pestLinkEl.href = pest.link;
                    pestLinkEl.style.display = 'inline-block';
                } else {
                    pestLinkEl.style.display = 'none';
                }

                resultEl.style.display = 'block';
                resultEl.scrollIntoView({ behavior: 'smooth' });
            } else {
                pestInfoEl.innerHTML = '<div class="no-results">No pests found matching your selection. Please try different symptoms.</div>';
                pestLinkEl.style.display = 'none';
                resultEl.style.display = 'block';
            }
        }

        // Reset tool state and UI
        function resetTool() {
            selectedPlant = null;
            selectedProblemArea = null;
            filteredPests = [];

            plantSelectEl.value = '';
            problemAreaSelectEl.value = '';
            symptomsContainerEl.innerHTML = '';

            const radios = document.querySelectorAll('input[name="symptom"]');
            radios.forEach(radio => radio.checked = false);

            problemAreaStepEl.style.display = 'none';
            symptomsStepEl.style.display = 'none';
            resultEl.style.display = 'none';

            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // On window load initialize everything
        window.onload = function () {
            injectStyles();
            createHTMLStructure();
            initTool();
        };
    </script>
</body>
</html>
