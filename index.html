<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Plant Pest Diagnostic Tool</title>
</head>
<body>
    <div id="CalculatorContainer"></div>

    <script>
        // Pest data structure based on the updated Excel content - all 68 pests
        const pestData = [
            {
                name: "Anthracnose",
                type: "Disease (Fungal)",
                plants: ["Beans", "Cucumbers", "Melons", "Peppers", "Tomatoes", "Trees (e.g., Dogwood, Sycamore)", "Turfgrass"],
                affectedParts: ["Leaves", "Stems", "Fruit/Vegetable"],
                symptoms: ["Sunken dark lesions on leaves, stems, or fruits", "Pink or orange gelatinous ooze may appear in wet conditions", "Curled or distorted leaves", "Premature leaf drop", "Twig dieback", "Poor flowering"],
                prevention: ["Avoid overhead watering", "Improve air circulation", "Rotate crops", "Plant resistant varieties"],
                control: ["Prune infected areas", "Apply copper or sulfur-based fungicides early", "Destroy fallen debris"],
                link: "https://www.almanac.com/pest/anthracnose"
            },
            {
                name: "Ants",
                type: "Insect (due to aphid or scale infestations)",
                plants: ["Various plants, especially with aphids"],
                affectedParts: ["None directly. Ants are indicative of aphids and farming their 'honeydew'."],
                symptoms: ["Trails of ants on stems and leaves", "Presence of aphids or scale insects", "Disturbed soil around roots", "Nests in mulch or pots"],
                prevention: ["Keep garden tidy", "Avoid sugary fertilizers", "Prune heavily infested areas"],
                control: ["Use ant-safe baits or diatomaceous earth if needed", "Reduce aphids to discourage ant activity"],
                link: "https://www.almanac.com/pest/ants"
            },
            {
                name: "Aphids",
                type: "Insect (Sap-sucking pest)",
                plants: ["Beans", "Beets", "Cucumber", "Gladiolus", "Impatiens", "Lettuce", "Melon", "Petunia", "Phlox", "Pumpkin", "Rudbeckia", "Spinach", "Squash", "Tomato"],
                affectedParts: ["Leaves", "Stems", "Buds", "Flowers", "Fruit/Vegetable"],
                symptoms: ["Clusters of tiny green, black, or white insects", "Curled or distorted leaves", "Sticky honeydew on surfaces", "Presence of ants", "Sooty mold growth"],
                prevention: ["Monitor regularly", "Avoid over-fertilizing", "Encourage beneficial insects", "Remove weeds nearby"],
                control: ["Spray with insecticidal soap or horticultural oil", "Introduce ladybugs or lacewings", "Hose off with water"],
                link: "https://www.almanac.com/pest/aphids"
            },
            {
                name: "Armyworm",
                type: "Insect",
                plants: ["Beans", "Corn", "Wheat", "Ryegrass"],
                affectedParts: ["Leaves", "Stems", "Fruit/Vegetable"],
                symptoms: ["Skeletonized or ragged leaves", "Chewed fruit", "Frass near feeding sites", "Visible striped caterpillars feeding in groups", "Damage often appears suddenly and spreads quickly"],
                prevention: ["Monitor regularly", "Remove weeds", "Avoid planting susceptible crops in infested areas"],
                control: ["Scout early and often", "Apply Bacillus thuringiensis (Bt) or spinosad", "Use neem oil", "Attract natural predators like birds and parasitic wasps"],
                link: "https://www.almanac.com/pest/armyworms-how-get-rid-lawn-pest"
            },
            {
                name: "Asparagus Bugs",
                type: "Insect",
                plants: ["Asparagus"],
                affectedParts: ["Stems (spears)", "Leaves"],
                symptoms: ["Chewed or ragged foliage", "Bent or scarred spears", "Dark eggs laid in rows on stems", "Larvae resembling tiny slugs", "Frass (insect droppings) on plants"],
                prevention: ["Remove plant debris after harvest", "Encourage beneficial insects", "Rotate crops away from asparagus beds"],
                control: ["Handpick beetles and larvae", "Use neem oil or insecticidal soap", "Apply sprays if infestation is severe"],
                link: "n/a"
            },
            {
                name: "Aster Yellows",
                type: "Disease (Phytoplasma, spread by leafhoppers)",
                plants: ["Asters", "Black-eyed Susans", "Carrots", "Celery", "Coneflowers", "Daisies", "Lettuce", "Potatoes", "Tomatoes", "Zinnias"],
                affectedParts: ["Leaves", "Stems", "Flowers", "Roots"],
                symptoms: ["Stunted growth", "Yellow or purple curled leaves", "Pale or green distorted flowers", "Witches' broom", "Deformed carrots", "Small or soft potato tubers", "Aerial tubers"],
                prevention: ["Eliminate nearby weeds", "Use resistant varieties", "Monitor and manage leafhopper populations early"],
                control: ["Remove infected plants immediately", "Control leafhoppers with floating row covers or insecticidal soap"],
                link: "n/a"
            },
            {
                name: "Black (Itersonilia) canker",
                type: "Disease (Fungal)",
                plants: ["Parsnips", "Carrots", "Parsley", "Coriander", "Chrysanthemums", "Asters", "Sunflowers"],
                affectedParts: ["Roots (especially crown and shoulder)", "Leaves", "Petioles", "Inflorescences"],
                symptoms: ["Shallow brown to black or purple-black cankers on root crowns", "Small orange to brown leaf spots with pale green halos", "Blighted flowers", "Secondary decay in root lesions"],
                prevention: ["Rotate crops", "Cover shoulders of root crops like parsnips and carrots with soil to prevent exposure"],
                control: ["Deep plowing to bury infected debris", "Control carrot rust fly"],
                link: ""
            },
            {
                name: "Black Root Rot",
                type: "Disease (Fungal)",
                plants: ["Geraniums", "Holly", "Pansies", "Petunias", "Vinca"],
                affectedParts: ["Roots", "Lower Leaves"],
                symptoms: ["Dark brown or black root lesions", "Pale yellow leaves", "Wilting", "Stunted growth", "Leaf drop"],
                prevention: ["Ensure good drainage", "Avoid overwatering", "Maintain soil pH below 5.5", "Reduce plant stress", "Control fungus gnats and other vectors"],
                control: ["Destroy infected plants", "Remove contaminated soil", "Sanitize tools and containers"],
                link: "n/a"
            },
            {
                name: "Blossom-End Rot",
                type: "Disease (Physiological disorder due to calcium deficiency)",
                plants: ["Tomatoes", "Eggplant", "Zucchini", "Bell Peppers"],
                affectedParts: ["Fruit"],
                symptoms: ["Dark, sunken lesion at the blossom end (bottom) of the fruit"],
                prevention: ["Maintain consistent watering", "Avoid high nitrogen fertilizers", "Ensure soil pH is around 6.2–6.8", "Add calcium only if a deficiency is confirmed by soil test"],
                control: ["Remove affected fruit", "Apply calcium sprays early in fruit development"],
                link: "https://www.almanac.com/pest/blossom-end-rot"
            },
            {
                name: "Cabbage Looper",
                type: "Insect",
                plants: ["Broccoli", "Cabbage", "Cauliflower", "Kale"],
                affectedParts: ["Leaves"],
                symptoms: ["Large, ragged holes", "Skeletonized areas", "Visible frass (insect droppings)"],
                prevention: ["Remove plant debris", "Use row covers", "Encourage beneficial insects like parasitic wasps"],
                control: ["Handpick larvae", "Apply Bacillus thuringiensis (Bt) or spinosad to leaves"],
                link: "https://www.almanac.com/pest/how-get-rid-cabbage-loopers"
            },
            {
                name: "Cabbage Maggots",
                type: "Insect",
                plants: ["Broccoli", "Brussels Sprouts", "Cabbage", "Cauliflower", "Radishes", "Turnips"],
                affectedParts: ["Roots", "Stems", "Bulbs"],
                symptoms: ["Wilting plants", "Soft stems", "Stunted growth", "Root rot", "Tunnels in roots"],
                prevention: ["Plant late", "Use row covers", "Rotate crops", "Destroy infected plants", "Avoid fresh manure in spring"],
                control: ["No effective treatment once damage is visible", "Remove and destroy infected plants", "Use floating row covers to prevent egg-laying"],
                link: "https://www.almanac.com/pest/cabbage-root-maggots"
            },
            {
                name: "Cabbage Worms",
                type: "Insect",
                plants: ["Broccoli", "Brussels sprouts", "Cabbage", "Cauliflower", "Radishes", "Turnips"],
                affectedParts: ["Leaves", "Heads", "Growing tips"],
                symptoms: ["Chewed holes", "Ragged edges", "Burrowed/deformed produce", "Dark green frass", "Yellow eggs on leaves"],
                prevention: ["Grow companion plants (e.g., thyme)", "Invite beneficial insects", "Maintain garden hygiene"],
                control: ["Handpick worms", "Apply Bacillus thuringiensis (Bt), spinosad, or insecticidal soap", "Use row covers"],
                link: "https://www.almanac.com/pest/cabbage-worms"
            },
            {
                name: "Carrot Rust Flies",
                type: "Insect",
                plants: ["Carrots", "Celery", "Celeriac", "Chervil", "Parsnips", "Parsley"],
                affectedParts: ["Leaves", "Roots"],
                symptoms: ["Yellowing, wilting, stunted growth, reddish tunnels"],
                prevention: ["Delay planting until after peak fly emergence", "Rotate crops yearly to non-host species", "Avoid planting near wild carrot or weeds", "Harvest carrots as soon as mature", "Remove all crop residue"],
                control: ["Discard infested roots", "Use floating row covers to prevent adult flies from laying eggs"],
                link: ""
            },
            {
                name: "Colorado Potato Beetles",
                type: "Insect",
                plants: ["Eggplant", "Potatoes", "Tomato", "Tomatillos"],
                affectedParts: ["Leaves", "Stem"],
                symptoms: ["Defoliation (loss of leaves)"],
                prevention: ["Rotate crops", "Remove weeds and alternate host plants like ground cherry and nightshade", "Apply straw mulch", "Use row covers to exclude beetles"],
                control: ["Handpick and drop in soapy water", "Lady beetles prey on eggs", "Apply Beauveria bassiana or spinosad to kill larvae and adults"],
                link: "https://www.almanac.com/pest/colorado-potato-beetles"
            },
            {
                name: "Corn Earworms",
                type: "Insect",
                plants: ["Beans", "Corn", "Cotton", "Peppers", "Sorghum", "Tomatoes"],
                affectedParts: ["Fruit/Vegetable (ears)", "Silks"],
                symptoms: ["Larvae feed on leaves, tassels, silks, and inside ears or fruit", "Entry holes at base of fruit stem", "Extensive frass (excrement)", "Distorted leaves", "Premature ripening"],
                prevention: ["Avoid planting near large cornfields (attracts moths)", "Use early-maturing varieties to escape peak infestation", "Encourage beneficial insects (lacewings, pirate bugs)", "Monitor with pheromone traps to time interventions"],
                control: ["Apply Bacillus thuringiensis (Bt) to silks during early silk stage", "Use spinosad or insecticidal soap", "Handpick larvae if visible"],
                link: "n/a"
            },
            {
                name: "Tomato Cracking",
                type: "Abiotic",
                plants: ["Tomatoes"],
                affectedParts: ["Fruit"],
                symptoms: ["Fruit skin splits from the stem downward, or cracks form rings around the stem end"],
                prevention: ["Regular, deep watering instead of letting it dry out completely", "Mulch with 2 to 3 inch layer of straw, shredded leaves, or compost", "Choose crack-resistant varieties", "Harvest promptly"],
                control: ["Harvest early to prevent rot", "Still edible but use quickly", "If deeply cracked, toss and compost"],
                link: "https://www.almanac.com/video/top-10-tomato-problems-and-solutions"
            },
            {
                name: "Crows",
                type: "Animal",
                plants: ["Apples", "Cherries", "Corn", "Melons", "Pumpkins", "Sorghum", "Sunflowers"],
                affectedParts: ["Fruit"],
                symptoms: ["Peck holes in fruit", "Consume small fruits whole", "Pull seedlings (especially corn)", "Leave fruit unsaleable", "Knock fruit to ground", "Feed on ripening grain and nuts"],
                prevention: ["Rotate crops", "Maintain clean fields", "Avoid planting vulnerable crops near roosting areas", "Use resistant or less attractive crop varieties when available"],
                control: ["Exclude with netting or monofilament lines", "Use scare devices (noise makers, reflective tape, predator decoys)", "Thin roost trees to reduce congregation"],
                link: "https://www.almanac.com/pest/crows"
            },
            {
                name: "Cucumber Beetles (Striped)",
                type: "Insect",
                plants: ["Beans", "Cantaloupe", "Corn", "Cucumbers", "Melons", "Squash", "Watermelon", "Zucchini"],
                affectedParts: ["Leaves", "Stems", "Fruit/Vegetable"],
                symptoms: ["Chewed leaves, wilted or stunted plants, scarred fruit"],
                prevention: ["Remove debris and alternate host plants", "Mulch with thick straw", "Use row covers before flowering", "Monitor for bacterial wilt"],
                control: ["Use floating row covers until flowering", "Handpick beetles", "Apply neem oil or pyrethrin if needed"],
                link: "https://www.almanac.com/pest/cucumber-beetles"
            },
            {
                name: "Cutworms",
                type: "Insect (Larvae of moths)",
                plants: ["Asparagus", "Beans", "Cabbage and other crucifers", "Carrots", "Celery", "Corn", "Lettuce", "Peas", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Stems", "Leaves", "Seedlings"],
                symptoms: ["Seedlings cut at base", "Cut stems near soil line", "Curled larvae in soil"],
                prevention: ["Wrap a 4-inch-wide collar made from cardboard/newspaper around each seedling stem", "Weed", "Remove plant debris", "Row covers"],
                control: ["Hand-pick larvae at night", "Use cardboard collars around stems", "Sprinkle diatomaceous earth or crushed eggshells around base", "Apply biological insecticides like Spinosad or Bt if needed"],
                link: "https://www.almanac.com/pest/cutworms"
            },
            {
                name: "Damping Off",
                type: "Disease (Fungal or Oomycete)",
                plants: ["Basil", "Broccoli", "Cabbage", "Cauliflower", "Celery", "Cucumbers", "Lettuce", "Melons", "Peppers", "Spinach", "Tomatoes"],
                affectedParts: ["Seedlings", "Stems", "Roots"],
                symptoms: ["Seeds fail to emerge", "Seedlings collapse at soil line", "Stems turn brown or black", "Roots rot", "Patches of missing or wilted seedlings"],
                prevention: ["Sanitize trays and tools", "Use sterile potting mix", "Avoid overwatering", "Provide good air circulation and bottom heat"],
                control: ["Improve drainage", "Use sterile potting mix", "Avoid overwatering", "Apply biological fungicides like Trichoderma or Bacillus subtilis if needed"],
                link: "n/a"
            },
            {
                name: "Deer",
                type: "Animal",
                plants: ["Apples", "Beans", "Cherries", "Corn", "Hostas", "Lettuce", "Peas", "Roses", "Spinach", "Sunflowers", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Buds", "Fruits", "Bark"],
                symptoms: ["Jagged tears on leaves and stems", "Stripped branches", "Missing buds or fruit", "Antler rubs on trunks", "Hoof prints or droppings nearby"],
                prevention: ["Avoid planting deer favorites in exposed areas", "Use resistant varieties", "Rotate plantings", "Maintain clean fields"],
                control: ["Install fencing or netting", "Use scare devices", "Apply natural repellents like garlic or hot pepper sprays"],
                link: "https://www.almanac.com/pest/how-keep-deer-out-garden"
            },
            {
                name: "Downy Mildew",
                type: "Disease",
                plants: ["Basil", "Broccoli", "Cucumbers", "Grapes", "Lettuce", "Melons", "Onions", "Peas", "Roses", "Spinach", "Sunflowers"],
                affectedParts: ["Leaves", "Stems", "Flowers", "Bulbs (in onions)"],
                symptoms: ["Yellow spots on upper leaf surface", "Gray or bluish fuzzy growth on undersides", "Leaf distortion", "Premature leaf drop", "Systemic bulb rot"],
                prevention: ["Space plants for airflow", "Use resistant varieties", "Avoid wet foliage", "Rotate crops away from susceptible hosts"],
                control: ["Remove infected plants", "Apply fungicides early and rotate modes of action", "Avoid overhead irrigation"],
                link: "https://www.almanac.com/pest/downy-mildew"
            },
            {
                name: "Early Blight",
                type: "Disease",
                plants: ["Eggplants", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruits"],
                symptoms: ["Brown leaf spots with concentric rings", "Yellow halos", "Lower leaves die first", "Stem lesions", "Fruit rot near stem end"],
                prevention: ["Rotate crops", "Mulch to reduce soil splash", "Avoid overhead watering", "Plant tolerant varieties"],
                control: ["Remove infected leaves", "Apply organic-approved fungicides like copper sprays early", "Prune for airflow"],
                link: "https://www.almanac.com/pest/early-blight"
            },
            {
                name: "Earwigs",
                type: "Insect",
                plants: ["Lettuce", "Spinach", "Basil", "Strawberries", "Corn", "Dahlias", "Marigolds", "Tomatoes"],
                affectedParts: ["Leaves", "Flowers", "Fruit", "Stems"],
                symptoms: ["Many small holes in leaves and fruit", "Seedlings clipped at ground level"],
                prevention: ["Remove plant debris", "Reduce moisture", "Trim vegetation", "Avoid overwatering", "Seal cracks and crevices", "Encourage natural predators like birds and frogs"],
                control: ["Trap in tuna can filled with ½ inch of fish oil, sunk in soil with rim slightly above ground", "Rolled damp newspaper traps", "Apply diatomaceous earth around plants"],
                link: "https://www.almanac.com/pest/earwigs"
            },
            {
                name: "Fire Ants",
                type: "Insect",
                plants: ["Beans", "Okra", "Peanuts", "Potatoes", "Sunflowers", "Tomatoes"],
                affectedParts: ["Seeds", "Seedlings", "Roots", "Fruits"],
                symptoms: ["Mounds near crops", "Stunted seedlings", "Chewed stems", "Ants protecting aphids", "Painful stings during harvest"],
                prevention: ["Use bait in spring and fall", "Manage adjacent lawn populations", "Avoid overwatering", "Monitor with greasy bait tests like potato chips"],
                control: ["Use granular baits and drenches labeled for organic use"],
                link: "https://www.almanac.com/pest/how-get-rid-fire-ants-immediately"
            },
            {
                name: "Fire Blight",
                type: "Disease (Bacterial)",
                plants: ["Apples", "Pears", "Quinces", "Crabapples", "Roses", "Hawthorn"],
                affectedParts: ["Blossoms", "Shoots", "Branches", "Fruits", "Roots"],
                symptoms: ["Blackened, scorched-looking shoots ('shepherd's crook')", "Oozing cankers", "Wilted flowers", "Dead leaves cling to branches"],
                prevention: ["Plant resistant varieties", "Avoid high nitrogen", "Prune only in dry weather", "Sanitize tools"],
                control: ["Prune 8–12 inches below infection during dormancy", "Sanitation is critical", "Sterilize tools between cuts", "Apply copper sprays during bloom"],
                link: "https://www.almanac.com/pest/how-identify-and-manage-fire-blight"
            },
            {
                name: "Flea Beetles",
                type: "Insect",
                plants: ["Broccoli", "Cabbage", "Eggplant", "Kale", "Peppers", "Radishes", "Tomatoes", "Turnips"],
                affectedParts: ["Leaves", "Stems", "Roots"],
                symptoms: ["Wilting, stunting, tiny round 'shot' holes", "Tiny black beetles jump when disturbed"],
                prevention: ["Mulch heavily", "Attract beneficial insects like braconid wasps", "Use row covers or fine screening during seedling stage", "Plant late", "Remove weeds and plant debris"],
                control: ["Hand-vacuum adults off leaves", "Use white sticky traps", "Apply neem oil or insecticidal soap"],
                link: "https://www.almanac.com/pest/flea-beetles"
            },
            {
                name: "Fungus Gnats",
                type: "Insect",
                plants: ["Houseplants", "Seedlings", "Potted Herbs", "Ornamentals"],
                affectedParts: ["Roots", "Stems (young plants)"],
                symptoms: ["Tiny black flies near soil", "Larvae in topsoil", "Sudden wilting", "Poor growth", "Slime trails on soil surface"],
                prevention: ["Let soil dry between watering", "Avoid overwatering", "Use sterile potting mix", "Remove decaying organic matter"],
                control: ["Destroy severely infested plants (DNC)", "Apply Bacillus thuringiensis israelensis (BTi) or beneficial nematodes", "Reduce watering"],
                link: "https://www.almanac.com/pest/fungus-gnats"
            },
            {
                name: "Fusarium Wilt",
                type: "Disease (Fungal)",
                plants: ["Tomatoes", "Peppers", "Eggplants", "Beans", "Lettuce", "Watermelon"],
                affectedParts: ["Leaves", "Stems", "Roots"],
                symptoms: ["One-sided yellowing", "Wilting during heat", "Brown streaks in stem cross-section", "Stunted growth"],
                prevention: ["Use resistant varieties (check race resistance)", "Rotate with non-host crops", "Sanitize tools and equipment"],
                control: ["Remove infected plants", "Avoid replanting susceptible crops", "Resistant varieties"],
                link: "https://www.almanac.com/pest/fusarium-wilt"
            },
            {
                name: "Gray Mold (Botrytis)",
                type: "Disease (Fungal)",
                plants: ["Strawberries", "Tomatoes", "Beans", "Roses", "Peonies", "Geraniums", "Lettuce"],
                affectedParts: ["Flowers", "Fruits", "Leaves", "Stems"],
                symptoms: ["Gray fuzzy mold on petals or fruit", "Water-soaked spots", "Cankers on stems", "Leaf blight"],
                prevention: ["Avoid overhead watering", "Increase spacing and airflow", "Remove spent flowers and debris", "Irrigate early in the day"],
                control: ["Remove infected tissue", "Apply copper-based fungicides or biofungicides like Bacillus subtilis early", "Refrigerate harvested produce properly"],
                link: "https://www.almanac.com/pest/gray-mold-or-botrytis"
            },
            {
                name: "Groundhogs",
                type: "Animal",
                plants: ["Beans", "Peas", "Tomatoes", "Carrots", "Lettuce", "Squash"],
                affectedParts: ["Leaves", "Stems", "Fruits", "Roots"],
                symptoms: ["Large bites from fruit", "Burrows near garden", "Toppled plants", "Gnawed stems"],
                prevention: ["Fence garden with 4-ft wire buried 12 inches", "Add electric wire at top", "Remove nearby brush piles and burrow sites"],
                control: ["Use live traps with fruit bait", "Install buried fencing with L-shaped barrier"],
                link: "https://www.almanac.com/pest/groundhogs"
            },
            {
                name: "Halo Blight",
                type: "Disease (Bacterial)",
                plants: ["Beans (Snap, Dry, Lima)"],
                affectedParts: ["Leaves", "Pods", "Stems"],
                symptoms: ["Small water-soaked leaf spots with yellow halos", "Pod lesions with bacterial ooze", "Systemic yellowing in cool weather"],
                prevention: ["Choose blight resistant varieties", "Use row covers", "Use certified disease-free seed", "Rotate with non-legumes", "Avoid overhead irrigation", "Sanitize tools"],
                control: ["Remove infected debris", "Apply copper sprays preventively", "Avoid working in wet fields"],
                link: "n/a"
            },
            {
                name: "Japanese Beetles",
                type: "Insect",
                plants: ["Roses", "Grapes", "Beans", "Linden Trees", "Corn", "Apples", "Plums", "Cherries", "Peaches", "Raspberries"],
                affectedParts: ["Leaves", "Flowers", "Fruit"],
                symptoms: ["Skeletonized leaves (eaten between veins)", "Shiny metallic green beetles ~½ inch long"],
                prevention: ["Cover plants after fruit set", "Avoid planting beetle-attracting species in problem areas", "Maintain healthy plants", "Delay lawn watering during peak egg-laying season", "Plant resistant varieties"],
                control: ["Start early, handpicking beetles", "Apply neem oil or insecticidal soap early while populations are small", "Apply milky spore or beneficial nematodes to soil"],
                link: "https://www.almanac.com/pest/japanese-beetles"
            },
            {
                name: "Late Blight",
                type: "Disease (Fungal-like)",
                plants: ["Potatoes", "Tomatoes", "Eggplants", "Peppers"],
                affectedParts: ["Leaves", "Stems", "Fruits", "Tubers"],
                symptoms: ["Water-soaked lesions on leaves", "Dark, greasy spots", "White fuzzy growth under leaves in humid conditions", "Fruit rot", "Tubers show firm brown decay"],
                prevention: ["Plant earlier in year, select blight resistant varieties", "Use certified seed", "Destroy cull piles and volunteers", "Avoid overhead irrigation", "Monitor weather and apply fungicides preventively"],
                control: ["Remove infected plants immediately", "Apply copper-based fungicides or biofungicides like Bacillus subtilis", "Avoid harvesting until vines are dead for 2–3 weeks"],
                link: "https://www.almanac.com/pest/late-blight-disease-tomatoes-and-potatoes-plants"
            },
            {
                name: "Leaf Hoppers",
                type: "Insect",
                plants: ["Beans", "Potatoes", "Apples", "Grapes", "Roses", "Dahlias", "Peas", "Eggplants", "Strawberries", "Carrots", "Lettuce", "Celery", "Ornamentals"],
                affectedParts: ["Leaves"],
                symptoms: ["V-shaped yellowing", "Leaf stippling", "Curling or twisted leaves", "Hopperburn (scorched edges)", "Stunted growth", "Sticky excrement", "Presence of tiny jumping insects"],
                prevention: ["Use row covers early in season", "Rotate crops", "Attract beneficial insects (ladybugs, lacewings)", "Avoid over-fertilizing", "Maintain garden hygiene"],
                control: ["Knock nymphs off with strong water spray", "Spray insecticidal soap or pyrethrin", "Release beneficial insects", "Remove infested leaves", "Apply kaolin clay as a deterrent"],
                link: "https://www.almanac.com/pest/leafhoppers"
            },
            {
                name: "Leaf Miners",
                type: "Insect",
                plants: ["Spinach", "Beets", "Chard", "Lettuce", "Peas", "Beans", "Tomatoes", "Cucumbers", "Celery", "Citrus", "Ornamentals"],
                affectedParts: ["Leaves"],
                symptoms: ["Squiggly trails or blotches on leaves", "Pale or translucent leaf spots", "Leaf curling", "Premature leaf drop", "Reduced vigor"],
                prevention: ["Use row covers early", "Remove and destroy infested leaves", "Avoid over-fertilizing", "Plant trap crops nearby"],
                control: ["Prune damaged foliage", "Apply neem oil", "Release parasitic wasps"],
                link: "https://www.almanac.com/pest/leaf-miners"
            },
            {
                name: "Leaf Spot",
                type: "Disease (Fungal or bacterial)",
                plants: ["Beans", "Corn", "Cucumbers", "Lettuce", "Peppers", "Roses", "Tomatoes", "Trees", "Shrubs"],
                affectedParts: ["Leaves", "Stems (occasionally)"],
                symptoms: ["Brown, black, or tan spots with yellow halos", "Spots may fall out leaving holes", "Premature leaf drop", "Defoliation over multiple seasons"],
                prevention: ["Rotate crops", "Avoid overhead watering", "Mulch properly", "Space plants well", "Plant resistant varieties"],
                control: ["Remove fallen leaves and plant debris", "Apply copper-based fungicides early", "Prune for airflow"],
                link: "n/a"
            },
            {
                name: "Mexican Bean Beetles",
                type: "Insect",
                plants: ["Lima Beans", "Snap beans", "Soybean"],
                affectedParts: ["Leaves", "Adults may also feed on flowers, stems, and pods"],
                symptoms: ["Underside of leaves between the veins", "Skeletonized appearance"],
                prevention: ["Row covers after planting (through harvest)", "Crush egg masses by hand", "Spray Neem"],
                control: ["Handpick", "Purchase and release beneficial wasp Pediobius foveolatus when larvae are observed", "Destroy severely infested plants"],
                link: "https://www.almanac.com/pest/mexican-bean-beetles"
            },
            {
                name: "Mice",
                type: "Animal",
                plants: ["Fruit trees", "Bulbs", "Vegetables", "Ornamentals", "Houseplants"],
                affectedParts: ["Roots", "Bark", "Seeds", "Leaves"],
                symptoms: ["Gnawed bark at base", "Burrowing in pots", "Chewed seedlings", "Droppings", "Nests in mulch or debris"],
                prevention: ["Keep garden tidy", "Seal compost bins", "Avoid mulch piles near crops", "Use wire mesh around trunks"],
                control: ["Use bait stations or traps", "Install tree guards", "Remove sheltering debris"],
                link: "https://www.almanac.com/pest/mice"
            },
            {
                name: "Moles",
                type: "Animal",
                plants: ["Lawns", "Bulbs", "Root crops", "Seedlings"],
                affectedParts: ["Roots (indirectly)", "Soil"],
                symptoms: ["Raised ridges in turf", "Volcano-shaped mounds", "Dislodged plants", "Uneven lawn surface"],
                prevention: ["Maintain healthy soil", "Reduce grub populations only if needed", "Avoid overwatering", "Tolerate minor mole activity if possible"],
                control: ["Traps", "Install underground mesh in raised beds", "Avoid ineffective repellents"],
                link: "https://www.almanac.com/pest/moles"
            },
            {
                name: "Mosaic Virus",
                type: "Disease (Viral)",
                plants: ["Beans", "Cucumbers", "Eggplants", "Lettuce", "Melons", "Peppers", "Potatoes", "Roses", "Squash", "Spinach", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruits", "Flowers", "Veins"],
                symptoms: ["Mottled yellow/green/white patches", "Crinkled or wavy leaves", "Stunted growth", "Misshapen fruits", "Shoestring leaf syndrome", "Twisted young growth"],
                prevention: ["Remove infected plants", "Control aphids with insecticidal soap or reflective mulches", "Sanitize tools between uses to prevent spread", "Use certified virus-free seeds and resistant varieties"],
                control: ["There is no cure for Mosaic Virus", "Infected plants must be removed and destroyed to prevent spread"],
                link: "https://www.almanac.com/pest/mosaic-viruses"
            },
            {
                name: "Onion Maggots",
                type: "Insect",
                plants: ["Onions", "Garlic", "Leeks", "Shallots", "Chives"],
                affectedParts: ["Bulbs", "Roots", "Base of stems"],
                symptoms: ["Wilting seedlings", "Yellowing leaves", "Soft or rotting bulbs", "Maggots in bulbs", "Poor germination", "Brown tunnels inside bulbs"],
                prevention: ["Rotate crops", "Use row covers", "Remove plant debris", "Avoid planting in cool, wet soil"],
                control: ["No effective treatment once bulbs are infested", "Discard affected plants", "Apply beneficial nematodes preemptively", "Use insecticidal seed treatments before planting"],
                link: "N/a but often grouped with Cabbage Maggots. Should we rename?"
            },
            {
                name: "Powdery Mildew",
                type: "Disease (Fungal)",
                plants: ["Beans", "Cucumbers", "Eggplants", "Grapes", "Lettuce", "Melons", "Peas", "Peppers", "Roses", "Squash", "Tomatoes", "Zinnias"],
                affectedParts: ["Leaves (especially upper surface)", "Stems", "Buds", "Flowers", "Fruits"],
                symptoms: ["White or gray powdery spots", "Leaf curling or distortion", "Yellowing leaves", "Premature leaf drop", "Reduced flowering or fruiting", "Stunted growth"],
                prevention: ["Improve air circulation: Space plants properly and prune dense growth", "Choose sunny spots: Shade encourages mildew", "Use resistant varieties: Especially for squash, cucumbers, and roses", "Clean up debris: Remove infected leaves and fallen plant matter"],
                control: ["Apply fungicides such as neem oil, sulfur, potassium bicarbonate, or horticultural oils", "DIY spray: Mix 1 tbsp baking soda + 1 tsp dish soap + 1 tbsp vegetable oil in 1 gallon water", "Prune infected parts and dispose of them—do not compost"],
                link: "https://www.almanac.com/pest/powdery-mildew"
            },
            {
                name: "Rabbits",
                type: "Animal",
                plants: ["Beans", "Lettuce", "Peas", "Roses", "Shrubs", "Trees", "Vegetables"],
                affectedParts: ["Leaves", "Stems", "Bark"],
                symptoms: ["Clean 45° cuts on stems", "Gnawed bark on young trees", "Droppings nearby", "Nests in tall grass"],
                prevention: ["Fence garden with 2-ft wire mesh buried 6 inches", "Use tree guards", "Remove brush piles"],
                control: ["Use repellents like blood meal or garlic spray", "Install motion-activated sprinklers"],
                link: "https://www.almanac.com/pest/rabbits"
            },
            {
                name: "Raccoons",
                type: "Animal",
                plants: ["Corn", "Melons", "Strawberries", "Grapes", "Berries", "Garbage"],
                affectedParts: ["Fruit", "Ears of corn"],
                symptoms: ["Partially eaten fruit", "Torn husks on corn", "Overturned pots", "Digging in lawns"],
                prevention: ["Harvest ripe fruit promptly", "Secure compost and garbage", "Install electric fencing"],
                control: ["Use motion-activated lights or sprinklers", "Apply repellents like capsaicin spray"],
                link: "https://www.almanac.com/pest/raccoons"
            },
            {
                name: "Root Knot Nematodes",
                type: "Nematode",
                plants: ["Tomatoes", "Carrots", "Potatoes", "Beans", "Peppers", "Lettuce", "Cucumbers", "Melons"],
                affectedParts: ["Roots"],
                symptoms: ["Stunted growth", "Yellowing leaves", "Galls or knots on roots", "Poor yield", "Wilting despite adequate water"],
                prevention: ["Rotate with resistant crops (corn, grains)", "Solarize soil", "Add organic matter", "Use resistant varieties"],
                control: ["Apply beneficial nematodes or fungi", "Remove and destroy infected plants", "Avoid spreading contaminated soil"],
                link: "https://www.almanac.com/pest/root-knot-nematodes"
            },
            {
                name: "Rust",
                type: "Disease (Fungal)",
                plants: ["Asparagus", "Beans", "Corn", "Hollyhocks", "Roses", "Snapdragons", "Sunflowers"],
                affectedParts: ["Leaves", "Stems"],
                symptoms: ["Orange, yellow, or brown powdery pustules", "Leaf yellowing", "Premature defoliation", "Stunted growth"],
                prevention: ["Space plants for airflow", "Water at base", "Remove infected debris", "Plant resistant varieties"],
                control: ["Remove infected leaves", "Apply sulfur or copper-based fungicides early", "Avoid overhead irrigation"],
                link: "https://www.almanac.com/pest/rust-plant-disease"
            },
            {
                name: "Scale Insects",
                type: "Insect",
                plants: ["Apples", "Azaleas", "Citrus", "Holly", "Magnolias", "Oaks", "Roses", "Shrubs", "Trees"],
                affectedParts: ["Stems", "Leaves", "Branches"],
                symptoms: ["Small bumps on stems and leaves", "Yellowing leaves", "Sticky honeydew", "Sooty mold", "Stunted growth"],
                prevention: ["Prune infested branches", "Encourage natural predators", "Avoid over-fertilizing"],
                control: ["Scrape off scales", "Apply horticultural oil during dormancy", "Use insecticidal soap", "Release ladybugs"],
                link: "https://www.almanac.com/pest/scale-insects"
            },
            {
                name: "Slugs and Snails",
                type: "Mollusk",
                plants: ["Hostas", "Lettuce", "Strawberries", "Cabbage", "Basil", "Marigolds", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruits"],
                symptoms: ["Large irregular holes", "Silvery slime trails", "Seedlings eaten to ground"],
                prevention: ["Remove hiding places", "Water in morning", "Use copper barriers", "Encourage predators"],
                control: ["Handpick at night", "Use beer traps", "Apply iron phosphate bait", "Sprinkle diatomaceous earth"],
                link: "https://www.almanac.com/pest/slugs-and-snails"
            },
            {
                name: "Spider Mites",
                type: "Arachnid",
                plants: ["Beans", "Cucumbers", "Eggplants", "Roses", "Strawberries", "Tomatoes", "Houseplants"],
                affectedParts: ["Leaves (undersides)"],
                symptoms: ["Fine webbing", "Yellow stippling", "Bronzed leaves", "Leaf drop", "Reduced vigor"],
                prevention: ["Increase humidity", "Avoid dusty conditions", "Monitor regularly", "Remove weeds"],
                control: ["Spray with water", "Apply insecticidal soap or neem oil", "Release predatory mites"],
                link: "https://www.almanac.com/pest/spider-mites"
            },
            {
                name: "Squash Bugs",
                type: "Insect",
                plants: ["Pumpkins", "Squash", "Cucumbers", "Melons"],
                affectedParts: ["Leaves", "Stems", "Fruits"],
                symptoms: ["Yellow spots that turn brown", "Wilting", "Stunted growth", "Frass on leaves"],
                prevention: ["Use row covers", "Remove plant debris", "Handpick eggs", "Plant resistant varieties"],
                control: ["Trap under boards", "Apply neem oil", "Use insecticidal soap", "Remove heavily infested plants"],
                link: "https://www.almanac.com/pest/squash-bugs"
            },
            {
                name: "Squash Vine Borers",
                type: "Insect",
                plants: ["Pumpkins", "Squash", "Zucchini", "Cucumbers"],
                affectedParts: ["Stems"],
                symptoms: ["Sudden wilting", "Sawdust-like frass", "Holes in stems", "Yellow eggs on stems"],
                prevention: ["Use row covers", "Plant late", "Choose resistant varieties", "Rotate crops"],
                control: ["Slit stems to remove borers", "Inject Bt into stems", "Remove and destroy infested plants"],
                link: "https://www.almanac.com/pest/squash-vine-borer"
            },
            {
                name: "Squirrels",
                type: "Animal",
                plants: ["Corn", "Sunflowers", "Tomatoes", "Fruit trees", "Bulbs"],
                affectedParts: ["Fruits", "Seeds", "Bulbs"],
                symptoms: ["Partially eaten fruit", "Dug-up bulbs", "Chewed husks", "Stolen produce"],
                prevention: ["Harvest promptly", "Use baffles on poles", "Net fruit trees", "Plant daffodils (squirrel-resistant)"],
                control: ["Use motion-activated sprinklers", "Apply hot pepper spray", "Provide alternative food sources"],
                link: "https://www.almanac.com/pest/squirrels"
            },
            {
                name: "Stink Bugs",
                type: "Insect",
                plants: ["Apples", "Beans", "Corn", "Peppers", "Tomatoes", "Squash"],
                affectedParts: ["Fruits", "Leaves", "Stems"],
                symptoms: ["Cat-facing on fruit", "Sunken areas", "Discolored spots", "Stunted growth"],
                prevention: ["Remove weeds", "Use row covers", "Handpick adults", "Plant trap crops"],
                control: ["Knock into soapy water", "Apply insecticidal soap", "Use neem oil", "Encourage predators"],
                link: "https://www.almanac.com/pest/stink-bugs"
            },
            {
                name: "Sunscald",
                type: "Abiotic",
                plants: ["Peppers", "Tomatoes", "Fruit trees"],
                affectedParts: ["Fruits", "Bark"],
                symptoms: ["White or pale patches on fruit", "Soft, sunken areas", "Blistered bark", "Cracking"],
                prevention: ["Provide afternoon shade", "Avoid excessive pruning", "Use whitewash on trunks", "Harvest promptly"],
                control: ["Remove affected fruit", "Protect with shade cloth", "Wrap young tree trunks"],
                link: "n/a"
            },
            {
                name: "Thrips",
                type: "Insect",
                plants: ["Onions", "Garlic", "Iris", "Gladiolus", "Roses", "Peppers", "Tomatoes"],
                affectedParts: ["Leaves", "Flowers", "Fruits"],
                symptoms: ["Silvery streaks", "Deformed flowers", "Black specks (frass)", "Stunted growth"],
                prevention: ["Use row covers", "Remove weeds", "Avoid over-fertilizing", "Monitor regularly"],
                control: ["Spray with water", "Apply insecticidal soap", "Use neem oil", "Release predatory mites"],
                link: "https://www.almanac.com/pest/thrips"
            },
            {
                name: "Tomato Hornworms",
                type: "Insect",
                plants: ["Eggplants", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Leaves", "Stems", "Fruits", "Blossoms"],
                symptoms: ["Chewed leaves", "Large green caterpillars", "Frass", "Defoliation", "Damaged tomatoes"],
                prevention: ["Use floating row covers early in season", "Rotate crops and avoid planting near previous nightshade beds", "Add native plants to attract beneficial insects", "Grow dill as a trap crop", "Plant basil or marigolds as repellents"],
                control: ["Handpick hornworms (wear gloves)", "Leave parasitized larvae with white cocoons", "Spray Bacillus thuringiensis (Bt) on young caterpillars", "Prune heavily infested branches"],
                link: "https://www.almanac.com/pest/tomato-hornworms"
            },
            {
                name: "Verticillium Wilt",
                type: "Disease (Fungal)",
                plants: ["Tomatoes", "Potatoes", "Eggplants", "Peppers", "Strawberries", "Maple trees"],
                affectedParts: ["Leaves", "Stems", "Roots"],
                symptoms: ["V-shaped yellowing", "Wilting", "Brown streaks in stems", "Stunted growth"],
                prevention: ["Plant resistant varieties", "Rotate crops", "Solarize soil", "Avoid susceptible plants"],
                control: ["Remove infected plants", "Fumigate soil if severe", "Use resistant rootstocks"],
                link: "https://www.almanac.com/pest/verticillium-wilt"
            },
            {
                name: "Whiteflies",
                type: "Insect",
                plants: ["Tomatoes", "Cucumbers", "Peppers", "Poinsettias", "Cabbage", "Citrus"],
                affectedParts: ["Leaves (undersides)"],
                symptoms: ["Cloud of white insects when disturbed", "Yellowing leaves", "Sticky honeydew", "Sooty mold", "Stunted growth"],
                prevention: ["Use row covers", "Remove weeds", "Monitor regularly", "Avoid over-fertilizing"],
                control: ["Spray with water", "Apply insecticidal soap", "Use yellow sticky traps", "Release beneficial insects"],
                link: "https://www.almanac.com/pest/whiteflies"
            },
            {
                name: "White Mold",
                type: "Disease (Fungal)",
                plants: ["Beans", "Lettuce", "Peppers", "Potatoes", "Tomatoes"],
                affectedParts: ["Stems", "Leaves", "Fruits"],
                symptoms: ["White cottony growth", "Water-soaked lesions", "Wilting", "Sclerotia (black structures)"],
                prevention: ["Space plants", "Improve airflow", "Avoid overhead watering", "Rotate crops"],
                control: ["Remove infected plants", "Apply fungicides early", "Solarize soil"],
                link: "n/a"
            },
            {
                name: "Wireworms",
                type: "Insect",
                plants: ["Carrots", "Potatoes", "Corn", "Wheat", "Beans"],
                affectedParts: ["Roots", "Tubers", "Seeds"],
                symptoms: ["Tunnels in roots", "Wilting", "Poor germination", "Holes in tubers"],
                prevention: ["Rotate crops", "Till soil", "Use bait traps", "Plant later in season"],
                control: ["Apply beneficial nematodes", "Use insecticidal treatments", "Remove infested plants"],
                link: "https://www.almanac.com/pest/wireworms"
            }
        ];

        // Function to create and inject the CSS
        function injectStyles() {
            const style = document.createElement('style');
            style.textContent = `
                #CalculatorContainer * {
                    box-sizing: border-box;
                    margin: 0;
                    padding: 0;
                    font-family: 'Georgia', serif; 
                }
                
                #CalculatorContainer body {
                    background-color: #fff;
                    color: #333;
                    line-height: 1.6;
                    padding: 20px;
                }
                
                #CalculatorContainer .container {
                    max-width: 1000px;
                    margin: 0 auto;
                    background: #f9f5e8;
                    border-radius: 10px;
                    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                    padding: 30px;
                }
                
                #CalculatorContainer header {
                    text-align: center;
                    margin-bottom: 30px;
                    padding-bottom: 20px;
                    border-bottom: 2px solid #ddd4d4;
                }
                
                #CalculatorContainer h1 {
                    color: #ad2a24;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .description {
                    color: #666;
                    font-size: 16px;
                    max-width: 800px;
                    margin: 0 auto;
                }
                
                #CalculatorContainer .step {
                    margin-bottom: 25px;
                    padding: 20px;
                    background: #fff;
                    border-radius: 8px;
                }
                
                #CalculatorContainer .step-title {
                    font-size: 18px;
                    font-weight: 600;
                    margin-bottom: 15px;
                    color: #af6b35;
                }
                
                #CalculatorContainer .form-group {
                    margin-bottom: 15px;
                }
                
                #CalculatorContainer label {
                    display: block;
                    margin-bottom: 8px;
                    font-weight: 500;
                    color: #555;
                }
                
                #CalculatorContainer select {
                    width: 100%;
                    padding: 12px;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                    font-size: 16px;
                    background-color: white;
                    transition: border-color 0.3s;
                }
                
                #CalculatorContainer select:focus {
                    outline: none;
                    border-color: #dfebe0;
                    box-shadow: 0 0 0 2px rgba(220, 104, 89, 0.2);
                }
                
                #CalculatorContainer .symptoms-container {
                    max-height: 300px;
                    overflow-y: auto;
                    padding: 10px;
                    background: white;
                    border: 1px solid #ddd;
                    border-radius: 6px;
                }
                
                #CalculatorContainer .symptom-option {
                    padding: 10px;
                    border: 1px solid #eee;
                    border-radius: 4px;
                    margin-bottom: 8px;
                    display: flex;
                    align-items: center;
                    transition: background-color 0.2s;
                }
                
                #CalculatorContainer .symptom-option:hover {
                    background: #f5f5f5;
                }
                
                #CalculatorContainer .symptom-option input[type="radio"] {
                    margin-right: 10px;
                    accent-color: #4CAF50;
                }
                
                #CalculatorContainer .symptom-option label {
                    margin-bottom: 0;
                    cursor: pointer;
                    flex-grow: 1;
                }
                
                #CalculatorContainer .result {
                    margin-top: 30px;
                    padding: 20px;
                    background: #fff;
                    border-radius: 8px;
                    display: none;
                }
                
                #CalculatorContainer .result h3 {
                    margin-bottom: 15px;
                    color: #af6b35;
                }
                
                #CalculatorContainer .pest-info {
                    background: white;
                    padding: 15px;
                    border-radius: 6px;
                    margin-bottom: 15px;
                    border: 1px solid #eee;
                }
                
                #CalculatorContainer .pest-name {
                    font-size: 20px;
                    font-weight: 600;
                    color: #ad2a24;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .pest-type {
                    display: inline-block;
                    background: #f9f5e8;;
                    color: #ad2a24;
                    padding: 4px 8px;
                    border-radius: 4px;
                    font-size: 14px;
                    margin-bottom: 10px;
                }
                
                #CalculatorContainer .pest-detail {
                    margin-bottom: 8px;
                }
                
                #CalculatorContainer .pest-detail strong {
                    color: #555;
                }
                
                #CalculatorContainer .pest-link {
                    display: inline-block;
                    padding: 10px 15px;
                    background: #4CAF50;
                    color: white;
                    text-decoration: none;
                    border-radius: 4px;
                    transition: background 0.3s;
                    margin-top: 10px;
                }
                
                #CalculatorContainer .pest-link:hover {
                    background: #3d8b40;
                }
                
                #CalculatorContainer .reset-btn {
                    display: inline-block;
                    padding: 10px 15px;
                    background: #666;
                    color: white;
                    border: none;
                    border-radius: 4px;
                    cursor: pointer;
                    margin-top: 15px;
                    transition: background 0.3s;
                }
                
                #CalculatorContainer .reset-btn:hover {
                    background: #555;
                }
                
                #CalculatorContainer .no-results {
                    text-align: center;
                    padding: 20px;
                    color: #666;
                    font-style: italic;
                }
                
                @media (max-width: 768px) {
                    #CalculatorContainer .container {
                        padding: 15px;
                    }
                    
                    #CalculatorContainer .step {
                        padding: 15px;
                    }
                    
                    #CalculatorContainer select {
                        font-size: 16px; /* Prevents zoom on iOS */
                    }
                    
                    #CalculatorContainer .symptoms-container {
                        max-height: 250px;
                    }
                }
            `;
            document.head.appendChild(style);
        }

        // Function to create the HTML structure
        function createHTMLStructure() {
            const calculatorContainer = document.getElementById('CalculatorContainer');
            
            calculatorContainer.innerHTML = `
                <div class="container">
                    <header>
                        <h1>Plant Pest Diagnostic Tool</h1>
                        <p class="description">Identify pests and diseases affecting your plants by selecting your plant type, problem area, and symptoms</p>
                    </header>
                    
                    <div class="step">
                        <h2 class="step-title">Step 1: Select a Plant</h2>
                        <div class="form-group">
                            <label for="plant-select">Choose a plant:</label>
                            <select id="plant-select">
                                <option value="">-- Select a plant --</option>
                                <!-- Plant options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="step" id="problem-area-step" style="display: none;">
                        <h2 class="step-title">Step 2: Select Problem Area</h2>
                        <div class="form-group">
                            <label for="problem-area-select">Where is the problem located?</label>
                            <select id="problem-area-select">
                                <option value="">-- Select problem area --</option>
                                <!-- Problem area options will be populated by JavaScript -->
                            </select>
                        </div>
                    </div>
                    
                    <div class="step" id="symptoms-step" style="display: none;">
                        <h2 class="step-title">Step 3: Select Symptoms</h2>
                        <div class="symptoms-container" id="symptoms-container">
                            <!-- Symptoms will be populated by JavaScript -->
                        </div>
                    </div>
                    
                    <div class="result" id="result">
                        <h3>Diagnosis Result</h3>
                        <div class="pest-info" id="pest-info">
                            <!-- Pest information will be populated by JavaScript -->
                        </div>
                        <a href="#" class="pest-link" id="pest-link" target="_blank">Learn More About This Pest</a>
                        <br>
                        <button class="reset-btn" onclick="resetTool()">Start Over</button>
                    </div>
                </div>
            `;
        }

        // Extract all unique plants from pest data and remove duplicates
        const allPlants = [...new Set(pestData.flatMap(pest => pest.plants))].sort();
        
        // Function to normalize plant names (remove plural forms)
        // Function to normalize plant names (remove plural forms and standardize)
function normalizePlantName(plant) {
    // Handle special cases first
    if (plant === "Trees (e.g., Dogwood, Sycamore)") return "Tree";
    if (plant === "Cabbage and other crucifers") return "Cabbage";
    
    // Handle Brussels Sprout variations
    if (plant.toLowerCase().includes("brussel")) {
        return "Brussels Sprout";
    }
    
    // Common plural to singular conversions
    const pluralToSingular = {
        "tomatoes": "Tomato",
        "trees": "Tree",
        "sprouts": "Sprout",
        "peppers": "Pepper",
        "cucumbers": "Cucumber",
        // Add more as needed
    };
    
    const lowerPlant = plant.toLowerCase();
    
    // Check if it matches any known plural forms
    for (const [plural, singular] of Object.entries(pluralToSingular)) {
        if (lowerPlant === plural || lowerPlant.includes(plural)) {
            return singular;
        }
    }
    
    // General rule: remove trailing 's' for plural forms
    if (plant.endsWith('s') && 
        !plant.endsWith('ss') && 
        plant !== "Beans" && 
        plant !== "Peas" &&
        plant !== "Corn" &&
        plant.length > 3) {
        return plant.slice(0, -1);
    }
    
    return plant;
}
        
        // Create a mapping of normalized names to original names
        const plantNameMap = {};
        allPlants.forEach(plant => {
            const normalized = normalizePlantName(plant);
            if (!plantNameMap[normalized]) {
                plantNameMap[normalized] = plant;
            }
        });
        
        // Get unique normalized plant names
        const uniquePlants = Object.keys(plantNameMap).sort();
        
        // DOM elements
        let plantSelectEl, problemAreaStepEl, problemAreaSelectEl, symptomsStepEl, symptomsContainerEl, resultEl, pestInfoEl, pestLinkEl;
        
        // State variables
        let selectedPlant = null;
        let selectedProblemArea = null;
        let filteredPests = [];
        
        // Initialize the tool
        function initTool() {
            // Get DOM elements after creating the HTML
            plantSelectEl = document.getElementById('plant-select');
            problemAreaStepEl = document.getElementById('problem-area-step');
            problemAreaSelectEl = document.getElementById('problem-area-select');
            symptomsStepEl = document.getElementById('symptoms-step');
            symptomsContainerEl = document.getElementById('symptoms-container');
            resultEl = document.getElementById('result');
            pestInfoEl = document.getElementById('pest-info');
            pestLinkEl = document.getElementById('pest-link');
            
            // Populate plant options with unique names
            uniquePlants.forEach(plant => {
                const option = document.createElement('option');
                option.value = plantNameMap[plant]; // Store the original name as value
                option.textContent = plant; // Display the normalized name
                plantSelectEl.appendChild(option);
            });
            
            // Add event listeners
            plantSelectEl.addEventListener('change', handlePlantChange);
            problemAreaSelectEl.addEventListener('change', handleProblemAreaChange);
        }
        
        // Plant selection handler
        function handlePlantChange() {
            selectedPlant = plantSelectEl.value;
            
            if (selectedPlant) {
                // Show problem area step
                problemAreaStepEl.style.display = 'block';
                
                // Clear previous problem area options
                problemAreaSelectEl.innerHTML = '<option value="">-- Select problem area --</option>';
                
                // Get all affected parts for the selected plant
                const affectedPartsForPlant = [...new Set(pestData
                    .filter(pest => pest.plants.includes(selectedPlant))
                    .flatMap(pest => pest.affectedParts)
                )].sort();
                
                // Populate problem area options
                affectedPartsForPlant.forEach(part => {
                    const option = document.createElement('option');
                    option.value = part;
                    option.textContent = part;
                    problemAreaSelectEl.appendChild(option);
                });
                
                // Scroll to problem area step
                problemAreaStepEl.scrollIntoView({ behavior: 'smooth' });
            } else {
                problemAreaStepEl.style.display = 'none';
                symptomsStepEl.style.display = 'none';
                resultEl.style.display = 'none';
            }
        }
        
        // Problem area selection handler
        function handleProblemAreaChange() {
            selectedProblemArea = problemAreaSelectEl.value;
            
            if (selectedProblemArea) {
                // Filter pests based on plant and problem area
                filteredPests = pestData.filter(pest => {
                    const hasPlant = pest.plants.includes(selectedPlant);
                    const hasAffectedPart = pest.affectedParts.includes(selectedProblemArea);
                    return hasPlant && hasAffectedPart;
                });
                
                // Show symptoms step
                symptomsStepEl.style.display = 'block';
                
                // Clear previous symptoms
                symptomsContainerEl.innerHTML = '';
                
                // Get all symptoms from pests that affect the selected plant AND problem area
                const allSymptoms = [...new Set(filteredPests.flatMap(pest => pest.symptoms))];
                
                if (allSymptoms.length === 0) {
                    symptomsContainerEl.innerHTML = '<div class="no-results">No symptoms found for this combination.</div>';
                    return;
                }
                
                // Create radio buttons for symptoms
                allSymptoms.forEach(symptom => {
                    const symptomOption = document.createElement('div');
                    symptomOption.className = 'symptom-option';
                    
                    const radio = document.createElement('input');
                    radio.type = 'radio';
                    radio.name = 'symptom';
                    radio.value = symptom;
                    radio.id = `symptom-${symptom.replace(/\s+/g, '-').toLowerCase()}`;
                    radio.addEventListener('change', () => handleSymptomChange(symptom));
                    
                    const label = document.createElement('label');
                    label.htmlFor = radio.id;
                    label.textContent = symptom;
                    
                    symptomOption.appendChild(radio);
                    symptomOption.appendChild(label);
                    symptomsContainerEl.appendChild(symptomOption);
                });
                
                // Scroll to symptoms step
                symptomsStepEl.scrollIntoView({ behavior: 'smooth' });
            } else {
                symptomsStepEl.style.display = 'none';
                resultEl.style.display = 'none';
            }
        }
        
        // Symptom selection handler
        function handleSymptomChange(selectedSymptom) {
            // Find pests that have this symptom and match the selected plant and problem area
            const matchingPests = filteredPests.filter(pest => 
                pest.symptoms.includes(selectedSymptom)
            );
            
            if (matchingPests.length > 0) {
                // For simplicity, just show the first matching pest
                const pest = matchingPests[0];
                
                // Display pest information
                pestInfoEl.innerHTML = `
                    <div class="pest-name">${pest.name}</div>
                    <div class="pest-type">${pest.type}</div>
                    <div class="pest-detail"><strong>Plants Affected:</strong> ${pest.plants.join(', ')}</div>
                    <div class="pest-detail"><strong>Affected Parts:</strong> ${pest.affectedParts.join(', ')}</div>
                    <div class="pest-detail"><strong>Symptoms:</strong> ${pest.symptoms.join('; ')}</div>
                    ${pest.prevention ? `<div class="pest-detail"><strong>Prevention:</strong> ${Array.isArray(pest.prevention) ? pest.prevention.join('; ') : pest.prevention}</div>` : ''}
                    ${pest.control ? `<div class="pest-detail"><strong>Control:</strong> ${Array.isArray(pest.control) ? pest.control.join('; ') : pest.control}</div>` : ''}
                `;
                
                // Set pest link
                if (pest.link && pest.link !== "n/a") {
                    pestLinkEl.href = pest.link;
                    pestLinkEl.style.display = 'inline-block';
                } else {
                    pestLinkEl.style.display = 'none';
                }
                
                // Show result
                resultEl.style.display = 'block';
                
                // Scroll to result
                resultEl.scrollIntoView({ behavior: 'smooth' });
            } else {
                pestInfoEl.innerHTML = '<div class="no-results">No pests found matching your selection. Please try different symptoms.</div>';
                pestLinkEl.style.display = 'none';
                resultEl.style.display = 'block';
            }
        }
        
        // Reset the tool
        function resetTool() {
            selectedPlant = null;
            selectedProblemArea = null;
            filteredPests = [];
            
            // Reset UI
            plantSelectEl.value = '';
            problemAreaSelectEl.value = '';
            symptomsContainerEl.innerHTML = '';
            
            // Uncheck any radio buttons
            const radioButtons = document.querySelectorAll('input[name="symptom"]');
            radioButtons.forEach(radio => radio.checked = false);
            
            problemAreaStepEl.style.display = 'none';
            symptomsStepEl.style.display = 'none';
            resultEl.style.display = 'none';
            
            // Scroll to top
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
        
        // Initialize the tool when page loads
        window.onload = function() {
            injectStyles();
            createHTMLStructure();
            initTool();
        };
    </script>
</body>
</html>